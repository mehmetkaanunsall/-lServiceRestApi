<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">



    <h:form id="frmHepsiburadaIntegration">

        <ui:include src="/pages/general/common/toolbarreport.xhtml" >
            <ui:param name="outputtext" value="#{loc.hepsiburadaintegration}"/>
            <ui:param name="bean" value='#{hepsiburadaIntegrationBean}' />
            <ui:param name="update" value="frmHepsiBuradaIntegrationDatatable:dtbHepsiBuradaIntegration pgrHepsiburadaIntegrationDatatable pgrHepsiburadaIntegration" />
        </ui:include>

        <h:panelGroup id="pgrHepsiburadaIntegration" layout="block" transient="true">  
            <div class="ui-g divContent">
                <div class="panelToggle ui-g-12">
                    <div class="ui-g-12 ui-md-6 ui-lg-2">
                        <p:outputLabel value="#{loc.stock}" for="txtStock" styleClass="Fs12 FontBold"/>
                        <p:inputText id="txtStock"  value="#{stockBookCheckboxFilterBean.selectedCount}" onclick="showStockBook()" class="inputPositionForBookFilter" readonly="#{facesContext.currentPhaseId.ordinal ge 4}" placeholder="#{loc.all}" >
                        </p:inputText>     
                        <p:commandLink id="btnStock" process="@this"  update="frmStockBookFilterCheckbox" actionListener="#{hepsiburadaIntegrationBean.openDialog()}" class="commandLinkPositionForBookFilter btnDisableButton" oncomplete="PF('olp_stockcheckbox').show();">
                            <i class="fa fa-book Fs16 iconPositionForBookFilter"></i>
                            <p:ajax   listener="#{stockBookCheckboxFilterBean.findFilterListLazyLoading([sessionBean.user.lastBranchSetting],'frmStockBookFilterCheckbox','olp_stockcheckbox','reportcheckboxwithbranch')}" />
                        </p:commandLink>
                    </div> 
                </div>
            </div> 
        </h:panelGroup>
        <p:remoteCommand name="showStockBook" process="@this" update="frmStockBookFilterCheckbox" oncomplete="PF('olp_stockcheckbox').show();" action="#{hepsiburadaIntegrationBean.openDialog()}" actionListener="#{stockBookCheckboxFilterBean.findFilterListLazyLoading([sessionBean.user.lastBranchSetting],'frmStockBookFilterCheckbox','olp_stockcheckbox','reportcheckboxwithbranch')}" />
    </h:form>
    <div class="EmptyBox20" />
    <h:panelGroup id="pgrHepsiburadaIntegrationDatatable" >
        <h:panelGroup rendered="#{hepsiburadaIntegrationBean.isFind}">

            <ui:include src="/pages/general/common/datagridtoolbarreport.xhtml" >
                <ui:param name="bean" value="#{hepsiburadaIntegrationBean}"/>
                <ui:param name="datatable" value="frmHepsiBuradaIntegrationDatatable:dtbHepsiBuradaIntegration" />
                <ui:param name="fileName" value="#{loc.hepsiburadaintegration}"/>
                <ui:param name="renderedToggler" value='false'/>
                <ui:param name="renderedExcel" value='false'/>
                <ui:param name="renderedPdf" value='false'/>
                <ui:param name="renderedPrint" value='false'/>
                <ui:param name="renderedGraphic" value='false'/>
                <ui:param name="renderedIntegration" value="true"/>
                <ui:param name="renderedIntegrationRemoveFromSale" value="true"/>
                <ui:param name="renderedIntegrationAllStocks" value="#{hepsiburadaIntegrationBean.listOfStock.size()==0 ? 'true' : hepsiburadaIntegrationBean.listOfStock.get(0).getId()==0 ? 'true' : 'false'}"/>
            </ui:include>

            <h:form id="frmHepsiBuradaIntegrationDatatable" >

                <p:dataTable  id="dtbHepsiBuradaIntegration"  var="ecommercestock"  value="#{hepsiburadaIntegrationBean.listOfObjects}" selection="#{hepsiburadaIntegrationBean.selectedEcommerceList}" widgetVar="ecommercestockPF" emptyMessage="#{loc.norecordsfound}"
                              rows="#{sessionBean.user.defualtGridSize}" rowKey="#{ecommercestock.stock.id}" paginator="true" paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {CurrentPageReport}"
                              rowsPerPageTemplate="#{sessionBean.user.gridSize}" paginatorPosition="bottom" currentPageReportTemplate="{startRecord}-{endRecord} #{loc.intotal} {totalRecords}" rowSelectMode="add" lazy="true"
                              class="salaryPaymentDatatable" >
                    <p:ajax event="page" global="false"/>
                    <p:ajax event="filter" global="false"/>
                    <p:ajax event="rowSelectCheckbox" global="false" listener="#{hepsiburadaIntegrationBean.rowSelect}"/>
                    <p:ajax event="rowUnselectCheckbox" global="false" listener="#{hepsiburadaIntegrationBean.rowUnSelect}"/>
                    <p:ajax event="toggleSelect" global="false" />


                    <p:columnGroup type="header">
                        <p:row>
                            <p:column rowspan="2" headerText=""/>
                            <p:column rowspan="2" headerText="#{loc.hepsiburadacode}"/>
                            <p:column rowspan="2" headerText="#{loc.merchantcode}"/>
                            <p:column rowspan="2" headerText="#{loc.stockbarcode}" />
                            <p:column rowspan="2" headerText="#{loc.stock}" />      
                            <p:column colspan="2" headerText="Hepsiburada" />      
                            <p:column colspan="2" headerText="Marwiz" />      
                            <p:column rowspan="2" headerText="#{loc.salesstatus}" />    
                            <p:column rowspan="2" headerText="#{loc.detail}" />    
                        </p:row>
                        <p:row>
                            <p:column headerText="#{loc.price}" />
                            <p:column headerText="#{loc.availablequantity}" />
                            <p:column headerText="#{loc.price}" />
                            <p:column headerText="#{loc.availablequantity}" />
                        </p:row>
                    </p:columnGroup>


                    <p:column selectionMode="multiple" style="width:26px; text-align:center;"  >
                    </p:column>

                    <p:column id="clmHepsiburadaSku" headerText="#{loc.hepsiburadacode}" selectRow="false">
                        <h:outputText value="#{ecommercestock.hepsiburadaSku}" />
                    </p:column>
                    <p:column id="clmMerchantSku" headerText="#{loc.merchantcode}" selectRow="false">
                        <h:outputText value="#{ecommercestock.merchantSku}" />
                    </p:column>
                    <p:column id="clmBarcode" headerText="#{loc.stockbarcode}" selectRow="false">
                        <h:outputText value="#{ecommercestock.stock.barcode}" />
                    </p:column>
                    <p:column id="clmStockName" headerText="#{loc.stock}" selectRow="false">
                        <h:outputText value="#{ecommercestock.stock.name}" />
                    </p:column>
                    <p:column id="clmPrice" headerText="#{loc.price}" selectRow="false">
                        <h:outputText  value="#{ecommercestock.price}" class="Fright">
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="currency" value="#{sessionBean.user.lastBranch.currency}"/>
                            <f:attribute name="type" value="currency" />
                        </h:outputText>
                    </p:column>
                    <p:column id="clmAvailableStock" headerText="#{loc.availablequantity}" selectRow="false">
                        <h:outputText  value="#{ecommercestock.availableStock}" class="Fright">
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="unit" value="#{ecommercestock.stock.unit}"/>
                            <f:attribute name="type" value="unit" />
                        </h:outputText>
                    </p:column>
                    <p:column id="clmMarwizPrice" headerText="#{loc.price}" selectRow="false">
                        <h:outputText  value="#{ecommercestock.marwizPrice}" class="Fright">
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="currency" value="#{sessionBean.user.lastBranch.currency}"/>
                            <f:attribute name="type" value="currency" />
                        </h:outputText>
                    </p:column>
                    <p:column id="clmMarwizAvailableStock" headerText="#{loc.availablequantity}" selectRow="false">
                        <h:outputText  value="#{ecommercestock.marwizAvailableStock}" class="Fright">
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="unit" value="#{ecommercestock.stock.unit}"/>
                            <f:attribute name="type" value="unit" />
                        </h:outputText>
                    </p:column>
                    <p:column id="clmSalesStatus" style="text-align: center !important; width: 80px;" selectRow="false">
                        <p:commandLink title="#{loc.insale}" rendered="#{ecommercestock.isSalableHepsiburada and ecommercestock.stock.id>0}" global="false">
                            <i class="fa fa-check Fs16" style="color: #2b9843"/>    
                        </p:commandLink> 
                        <p:commandLink title="#{loc.notinsale}" rendered="#{!ecommercestock.isSalableHepsiburada and ecommercestock.stock.id>0}" global="false">
                            <i class="fa fa-times Fs16 red"/>   
                        </p:commandLink> 
                    </p:column>
                    <p:column id="clmDetail" style="text-align: center !important; width: 80px;" headerText="#{loc.detail}" selectRow="false">
                        <p:commandLink title="#{loc.detail}" action="#{hepsiburadaIntegrationBean.goToDetail()}" update="dlgDetail" resetValues="true" rendered="#{ecommercestock.stock.id>0}">
                            <i class="fa fa-search Fs16"/>   
                            <f:setPropertyActionListener value="#{ecommercestock}"  target="#{hepsiburadaIntegrationBean.selectedEcommerceStock}"  />
                            <p:ajax />
                        </p:commandLink> 
                    </p:column>

                </p:dataTable>  

                <p:remoteCommand name="updateDatatable" update="frmHepsiBuradaIntegrationDatatable:dtbHepsiBuradaIntegration" delay="3000"/>
            </h:form>


        </h:panelGroup>
    </h:panelGroup>

    <p:dialog id="dlgDetail" widgetVar="dlg_Detail" resizable="false" transient="true" focus="dlgDetail" modal="true" responsive="true" dynamic="true"  closeOnEscape="true" width="20%">
        <ui:include src="/pages/system/hepsiburadaintegration/hepsiburadalistingdetail.xhtml" />
    </p:dialog>
    
     <!--Kitaptan stok seçtirmek için açılan overlay panel-->
    <ui:include src="/pages/general/common/stockbookcheckbox.xhtml" >
        <ui:param name="updateBean" value='#{hepsiburadaIntegrationBean}' />
        <ui:param name="for" value='frmHepsiburadaIntegration:btnStock' />
        <ui:param name="type" value='reportcheckboxwithbranch' />   
        <ui:param name="parameters" value='#{[sessionBean.user.lastBranchSetting]}' /> 
        <ui:param name="columnsize" value='4' /> 
        <ui:param name="form" value='frmStockBookFilterCheckbox' /> 
        <ui:param name="overlay" value="olp_stockcheckbox" />
    </ui:include>
     
     <p:confirmDialog id="dlgSendAllStocks"  class="deleteConfirm controlDelete"  widgetVar="dlg_SendAllStocks" closable="true" width="15%" responsive="true">
         <f:facet name="message">
             <p:panel class="divContent">
                 <div class="ui-g">
                     <div class="ui-g-12 ui-md-12 ui-lg-12">
                         <h:outputText value="#{loc.areyousuretosendallstockstohepsiburada}" />
                     </div>
                     <div class="ui-g-12 ui-md-12 ui-lg-6">
                         <p:commandButton value="#{loc.yes}" action="#{hepsiburadaIntegrationBean.sendAllStocks()}" onclick="PF('dlg_SendAllStocks').hide()" process="@this" styleClass="ui-confirmdialog-yes" icon="ui-icon-check fa fa-check Fs14 white"   />
                     </div>
                     <div class="ui-g-12 ui-md-12 ui-lg-6">
                         <p:commandButton value="#{loc.no}" type="button" onclick="PF('dlg_SendAllStocks').hide()" styleClass="ui-confirmdialog-no" icon="ui-icon-close fa fa-close Fs14 white" />
                     </div>
                 </div>
             </p:panel>
         </f:facet>
     </p:confirmDialog>


</ui:composition>