<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">



    <h:form id="frmMovementTab" style="padding: 5px 6px 0px 6px;">
        <div class="EmptyBox20" />
        <ui:include src="/pages/general/common/processtoolbar.xhtml" >
            <ui:param name="outputtext" value="#{loc.movements}"/>
            <ui:param name="selectedObjectName" value=""/>
            <ui:param name="bean" value='#{warehouseMovementTabBean}' />
            <ui:param name="update" value="tbvTankProc:dtbItems" />
            <ui:param name="btnSaveId" value="false" />
            <ui:param name="renderback" value='false'/>
            <ui:param name="btnDeleteId" value='false' /> 
            <ui:param name="renderSelectedObject" value='false'/>
            <ui:param name="renderedFindReport" value='true'/>
        </ui:include>


        <h:panelGroup id="pgrMovementProcess" layout="block" transient="true">  
            <div class="ui-g divContent">
                <div class="ui-g-12">
                    <div class="ui-g-12 ui-md-6 ui-lg-2">
                        <p:outputLabel value="#{loc.startdate}" for="cldStartDate" styleClass="Fs12 FontBold"/>
                        <p:calendar  id="cldStartDate" class="datepicker" value="#{tankMovementTabBean.beginDate}" required="true" beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm:ss" timeControlType="select" showOn="button" showButtonPanel="true" placeholder="#{loc.startdate}" mask="true" navigator="true" locale="#{sessionBean.locale}" yearRange="c-100:c+20" >
                            <p:ajax event="change" update="cldStartDate" resetValues="true" global="false"/>
                        </p:calendar>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-2">
                        <p:outputLabel value="#{loc.enddate}" for="cldEndDate" styleClass="Fs12 FontBold"/>
                        <p:calendar  id="cldEndDate" class="datepicker" value="#{tankMovementTabBean.endDate}" required="true" beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm:ss" timeControlType="select" showOn="button" showButtonPanel="true" placeholder="#{loc.enddate}" mask="true" navigator="true" locale="#{sessionBean.locale}" yearRange="c-100:c+20" >
                            <p:ajax event="change" update="cldEndDate" resetValues="true" global="false"/>
                        </p:calendar>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <p:outputLabel value="#{loc.processtype}" for="srdOperationType" styleClass="Fs12 FontBold"/>
                        <p:panelGrid layout="grid" columns="1" class="pngCheckBox" >  
                            <p:selectOneRadio id="srdOperationType" value="#{tankMovementTabBean.opType}" class="srcExtractRadio" layout="responsive" columns="3" >
                                <f:selectItem itemLabel="#{loc.entry}" itemValue="1" />
                                <f:selectItem itemLabel="#{loc.exit}" itemValue="2" />
                                <f:selectItem itemLabel="#{loc.all}" itemValue="3" />
                                <p:ajax  listener="#{tankMovementTabBean.find()}" update="tbvTankProc:dtbItems"/>
                            </p:selectOneRadio>
                        </p:panelGrid>
                    </div> 


                </div>  
            </div>
        </h:panelGroup>


    </h:form>
    <div class="EmptyBox20" />

    <h:panelGroup id="pgrMovementDatatableProcess">
        <div class="ui-g">

            <div class="ui-g-12 ui-md-12 ui-lg-12">
                <h:form id="tabTankMovement"   >
                    <ui:include src="/pages/general/common/tabgridtoolbar.xhtml">
                        <ui:param name="bean" value="#{tankMovementTabBean}"/>
                        <ui:param name="btnNewId" value="false"/>
                        <ui:param name="update" value="" />
                        <ui:param name="renderedExcel" value="true" />
                        <ui:param name="outputtext" value="#{loc.movements}" />

                    </ui:include>
                </h:form>
                <p:dataTable id="dtbItems" var="items" value="#{tankMovementTabBean.listOfObjects}"  selectionMode="single"   selection="#{tankMovementTabBean.selectedObject}"
                             rowKey="#{items.id}" emptyMessage="#{loc.norecordsfound}" class="tabDatatable"  rows="#{sessionBean.user.defualtGridSize}"
                             paginator="true" paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {CurrentPageReport}"
                             rowsPerPageTemplate="#{sessionBean.user.gridSize}" paginatorPosition="bottom" currentPageReportTemplate="{startRecord}-{endRecord} #{loc.intotal} {totalRecords}" 
                             reflow="true" lazy="true"> 

                    <p:column id="clmDate" headerText="#{loc.date}" >
                        <h:outputText value="#{items.moveDate}" >
                            <f:convertDateTime pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm:ss" />
                        </h:outputText>
                    </p:column>

                    <p:column id="clmDocumentNumberName" headerText="#{loc.documentnumber}">
                        <h:outputText value="#{items.warehouseReceipt.receiptNumber}" />
                    </p:column>

                    <p:column id="clmType" headerText="#{loc.description}">
                        <h:outputText value="#{items.type == 1 ? loc.sales : (items.type == 2 ? loc.invoice : loc.warehousereceipt)}" />
                    </p:column>



                    <p:column id="clmEntry" headerText="#{loc.entryamount}"   >
                        <h:outputText value="#{items.isDirection ? items.quantity:0}"  class="Fright" >
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="unit" value="#{items.stock.unit}"/>
                            <f:attribute name="type" value="unit" />
                        </h:outputText>
                    </p:column>

                    <p:column id="clmExit" headerText="#{loc.exitamount}"   >
                        <h:outputText value="#{items.isDirection ? 0:items.quantity }"  class="Fright" >
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="unit" value="#{items.stock.unit}"/>
                            <f:attribute name="type" value="unit" />
                        </h:outputText>
                    </p:column>

                    <p:column id="clmremamount" headerText="#{loc.remainingamount}" >
                        <h:outputText value="#{items.remainingAmount}"  class="Fright" >
                            <f:converter converterId="currencyConverter"  />
                            <f:attribute name="unit" value="#{items.stock.unit}"/>
                            <f:attribute name="type" value="unit" />
                        </h:outputText>
                    </p:column>

                    <p:column id="clmUnitPriceWithoutTax" headerText="#{loc.withouttax} #{loc.unitprice}"   >
                        <h:outputText value="#{items.unitPriceWithoutTax}"  class="Fright" >
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="currency" value="#{sessionBean.user.lastBranch.currency}"/>
                            <f:attribute name="type" value="currency" />
                        </h:outputText>
                    </p:column>

                    <p:column id="clmUnitPriceWithTax" headerText="#{loc.unitprice} (#{loc.withtax}) "   >
                        <h:outputText value="#{items.unitPriceWithTax}"  class="Fright" >
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="currency" value="#{sessionBean.user.lastBranch.currency}"/>
                            <f:attribute name="type" value="currency" />
                        </h:outputText>
                    </p:column>

                    <p:column id="clmTotalPrice" headerText="#{loc.sum} (#{loc.withouttax})" >
                        <h:outputText value="#{items.totalPrice}" class="Fright" >
                            <f:converter converterId="currencyConverter"  />
                            <f:attribute name="currency"  value="#{sessionBean.user.lastBranch.currency}" />
                            <f:attribute name="type" value="currency" />
                        </h:outputText>
                    </p:column>

                    <p:column id="clmTotalMoney" headerText="#{loc.sum} (#{loc.withtax})" >
                        <h:outputText value="#{items.totalMoney}" class="Fright">
                            <f:converter converterId="currencyConverter"  />
                            <f:attribute name="currency"  value="#{sessionBean.user.lastBranch.currency}" />
                            <f:attribute name="type" value="currency" />
                        </h:outputText>
                    </p:column>


                    <p:column id="clmTaxRate" headerText="#{loc.taxrate}" >
                        <h:outputText  value="#{items.taxRate}" class="Fright">
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="currency" value=""/>
                            <f:attribute name="type" value="percent" />
                        </h:outputText>
                    </p:column>

                    <p:column id="clmUserRate" headerText="#{loc.user}" >
                        <h:outputText  value="#{items.userCreated.fullName}">
                        </h:outputText>
                    </p:column>

                    <p:column id="clmBarcode" headerText="#{loc.stockbarcode}" >
                        <h:outputText  value="#{items.stock.barcode}" />
                    </p:column>

                    <p:column id="clmStockCode" headerText="#{loc.stockcode}" >
                        <h:outputText  value="#{items.stock.code}" />
                    </p:column>

                </p:dataTable>
            </div>

        </div>
    </h:panelGroup>



</ui:composition>

