<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core">



    <h:form id="frmMovementTab" style="padding: 5px 6px 0px 6px;">
        <div class="EmptyBox10" />
        <ui:include src="/pages/general/common/processtoolbar.xhtml" >
            <ui:param name="outputtext" value="#{loc.movements}"/>
            <ui:param name="selectedObjectName" value=""/>
            <ui:param name="bean" value='#{incomeExpenseMovementTabBean}' />
            <ui:param name="update" value="tbvMovement:frmMovementTab:pgrMovementProcess tbvMovement:frmMovementDataTable:dtbMovement" />
            <ui:param name="btnSaveId" value="false" />
            <ui:param name="renderback" value='false'/>
            <ui:param name="btnDeleteId" value='false' /> 
            <ui:param name="renderSelectedObject" value='false'/>
            <ui:param name="renderedFindReport" value='true'/>
        </ui:include>


        <h:panelGroup id="pgrMovementProcess" layout="block" transient="true">  
            <div class="ui-g divContent">
                <div class="ui-g-12">
                    <div class="ui-g-12 ui-md-6 ui-lg-3">
                        <p:outputLabel value="#{loc.startdate}" for="cldStartDate" styleClass="Fs12 FontBold"/>
                        <p:calendar  id="cldStartDate" class="datepicker" value="#{incomeExpenseMovementTabBean.beginDate}" required="true" beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm:ss" timeControlType="select"  showOn="button" showButtonPanel="true" placeholder="#{loc.startdate}" mask="true" navigator="true" locale="#{sessionBean.locale}" yearRange="c-100:c+20" >
                            <p:ajax event="change" update="cldStartDate" resetValues="true" global="false"/>
                        </p:calendar>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-3">
                        <p:outputLabel value="#{loc.enddate}" for="cldEndDate" styleClass="Fs12 FontBold"/>
                        <p:calendar  id="cldEndDate" class="datepicker" value="#{incomeExpenseMovementTabBean.endDate}" required="true" beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm:ss" timeControlType="select"  showOn="button" showButtonPanel="true" placeholder="#{loc.enddate}" mask="true" navigator="true" locale="#{sessionBean.locale}" yearRange="c-100:c+20" >
                            <p:ajax event="change" update="cldEndDate" resetValues="true" global="false"/>
                        </p:calendar>
                    </div>

                </div>  
            </div>
        </h:panelGroup>
    </h:form>
    <div class="EmptyBox10" />
    <h:panelGroup id="pgrMovementDatatableProcess">
        <div class="ui-g">
            <div class="ui-g-12">
                <h:panelGroup rendered="#{incomeExpenseMovementTabBean.isFind}">

                    <ui:include src="/pages/general/common/datagridtoolbarreport.xhtml" >
                        <ui:param name="bean" value="#{incomeExpenseMovementTabBean}"/>
                        <ui:param name="datatable" value="tbvMovement:frmMovementDataTable:dtbMovement" />
                        <ui:param name="fileName" value=""/>
                        <ui:param name="renderedToggler" value='false'/>
                        <ui:param name="renderedExcel" value='true'/>
                        <ui:param name="renderedPdf" value='true'/>
                        <ui:param name="renderedPrint" value='true'/>
                        <ui:param name="renderedGraphic" value='false'/>
                        <ui:param name="renderedAdd" value='#{incomeExpenseMovementTabBean.getRendered(161, 0)}'/>
                    </ui:include>
                      
                    <h:form id="frmMovementDataTable">

                        <p:dataTable  id="dtbMovement" var="movement"  value="#{incomeExpenseMovementTabBean.listOfObjects}" widgetVar="movementPF" selection="#{incomeExpenseMovementTabBean.selectedObject}"  selectionMode="single" emptyMessage="#{loc.norecordsfound}"
                                      rowsPerPageTemplate="#{sessionBean.user.gridSize}" rows="#{sessionBean.user.defualtGridSize}"  rowKey="#{movement.id}" paginator="true" paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {CurrentPageReport}"
                                      paginatorPosition="bottom" currentPageReportTemplate="{startRecord}-{endRecord} #{loc.intotal} {totalRecords}" 
                                      reflow="true" lazy="true" class="dialogDatatable"  >
                            
                            <!-- <p:ajax event="colReorder" listener="#{incomeExpenseMovementTabBean.reorder}" update="frmGridToolbar:toggle" />     -->
                        <p:ajax event="colResize"  listener="#{incomeExpenseMovementTabBean.onResize}" />

                            <p:ajax event="#{sessionBean.user.gridRowSelect}" listener="#{incomeExpenseMovementTabBean.getfinancingDocument()}"  /> 
                            <p:column id="clmMovementDate" headerText="#{loc.date}"  >
                                <h:outputText value="#{movement.movementDate}">
                                    <f:convertDateTime pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm:ss" />
                                </h:outputText>
                            </p:column>


                            <p:column id="clmDocumentNumber" headerText="#{loc.documentnumber}" >
                                <h:outputText value="#{movement.financingDocument.id==0 ? loc.transferbalance : movement.financingDocument.documentNumber }"/>
                            </p:column>
                            
                            <p:column id="clmDescription" headerText="#{loc.description}" >
                                <h:outputText value="#{movement.financingDocument.description}"/>
                            </p:column>

                            <p:column id="clmFinancingDocumentType" headerText="#{loc.processtype}" >
                                <h:outputText value="#{movement.financingDocument.financingType.tag}"/>
                            </p:column>

                            <p:column id="clmPrice" headerText="#{loc.total}" >

                                <h:outputText value="#{movement.price}" style="float: right;">
                                    <f:converter converterId="currencyConverter" />
                                    <f:attribute name="currency" value="#{movement.currency}"/>
                                    <f:attribute name="type" value="currency" />
                                </h:outputText>

                            </p:column>
                            <p:columnGroup type="footer" class="Fright">
                                <ui:repeat value="#{incomeExpenseMovementTabBean.listOfTotals}" var="totals" >
                                    <p:row>
                                        <p:column colspan="#{incomeExpenseMovementTabBean.toogleList.size()-incomeExpenseMovementTabBean.countToggle-1}" style="text-align:right; font-weight: bold; " priority="1">
                                            <f:facet name="footer"  >
                                                <h:outputText value="#{loc.sum} :" style="text-align:right; font-weight: bold; font-size: 15px; " />
                                            </f:facet>
                                        </p:column>
                                        <p:column colspan="1" style="text-align:right; font-weight: bold; ">
                                            <f:facet name="footer"  >
                                                <h:outputText  style="text-align:right; font-weight: bold; font-size: 15px; " value="#{totals.price}" >
                                                    <f:converter converterId="currencyConverter" />
                                                    <f:attribute name="currency" value="#{totals.currency}"/>
                                                    <f:attribute name="type" value="currency" />
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                    </p:row>
                                </ui:repeat>
                            </p:columnGroup> 

                        </p:dataTable>  
                    </h:form>

                </h:panelGroup>
            </div>
        </div>
    </h:panelGroup>


</ui:composition>
