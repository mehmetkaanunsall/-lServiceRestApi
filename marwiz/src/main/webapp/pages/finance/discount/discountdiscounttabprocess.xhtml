<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">


    <h:form id="frmDiscountDiscountTabProcess">
        <ui:include src="/pages/general/common/processtoolbar.xhtml" >
            <ui:param name="outputtext" value="#{loc.detail}"/>
            <ui:param name="bean" value='#{discountDiscountTabBean}' />
            <ui:param name="update" value="grdDiscountDiscountTab" />
            <ui:param name="btnSaveId" value="#{discountDiscountTabBean.selectedDiscount.centercampaign_id == 0 and discountDiscountTabBean.getRendered(99, 0)}" />      
            <ui:param name="btnDeleteId" value='false' />
            <ui:param name="privateDelete" value="true"/>
            <ui:param name="btnDeleteId" value="#{discountDiscountTabBean.processType==2 and discountDiscountTabBean.selectedDiscount.centercampaign_id == 0 and discountDiscountTabBean.getRendered(100, 0)}" />
            <ui:param name="btnTestBeforeDeleteId" value="#{discountDiscountTabBean.processType==2}" />
            <c:if test="#{discountDiscountTabBean.processType==2}">
                <ui:param name="renderedHistory" value="true"/>
            </c:if>
        </ui:include>
        <p:growl id="grwDiscountItemControl" showDetail="true" life="5000" globalOnly="true" />
        <h:panelGroup id="grdDiscountDiscountTab" layout="block">

            <div class="ui-g divContent">

                <div class="ui-g-12 ui-md-6 ui-lg-6">
                    <h:panelGroup id="pgrLabel">
                        <p:outputLabel value="#{discountDiscountTabBean.isAmount ? loc.discountamount : loc.discountrate}"  styleClass="Fs12 FontBold"/>
                    </h:panelGroup>

                    <p:commandLink id="sbbAmount" title="#{discountDiscountTabBean.isAmount ? loc.discountrate : loc.discountamount}" class="MarLeft4">
                        <i class="fa fa-refresh Fs14 tlbrAddBtn"></i> 
                        <p:ajax update="pgrDiscount pgrLabel sbbAmount pngTax" listener="#{discountDiscountTabBean.renderDiscountRateAmount()}"/>
                    </p:commandLink>
                    <h:panelGroup id="pgrDiscount">
                        <p:inputNumber id="txtDiscountAmount" value="#{discountDiscountTabBean.selectedObject.discountAmount}" rendered="#{discountDiscountTabBean.isAmount}" disabled="#{discountDiscountTabBean.selectedObject.priceList.id!=0}"
                                       decimalSeparator="#{sessionBean.user.lastBranch.decimalsymbol == 1 ? '.': ','}" thousandSeparator="#{sessionBean.user.lastBranch.decimalsymbol == 1 ? ',': '.'}" 
                                       roundMethod="D" symbolPosition="#{sessionBean.locale=='tr' ? 'p': 's'}"
                                       required="true" class="Wid90 TexAlRight" placeholder="#{loc.discountamount}" >                 

                        </p:inputNumber>
                        <p:inputNumber id="txtDiscountRate" symbol="%" disabled="#{discountDiscountTabBean.selectedObject.priceList.id!=0}"
                                       minValue="0" value="#{discountDiscountTabBean.selectedObject.discountRate}" required="true" rendered="#{!discountDiscountTabBean.isAmount}"
                                       decimalSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1? '.': ','}" thousandSeparator="#{sessionBean.user.lastBranch.decimalsymbol == 1 ? ',': '.'}" 
                                       roundMethod="D" symbolPosition="#{sessionBean.locale=='tr' ? 'p': 's'}" emptyValue="sign">  

                        </p:inputNumber>
                    </h:panelGroup>

                </div> 
                <div class="ui-g-12 ui-md-6 ui-lg-6">
                    <h:panelGroup id="pngTax">

                        <p:outputLabel value="#{loc.kdv}" for="slcKDV" class="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcKDV" value="#{discountDiscountTabBean.selectedObject.isTaxIncluded}" required="true" disabled="#{discountDiscountTabBean.selectedObject.priceList.id!=0}"> 
                            <f:selectItem itemLabel="#{loc.choose}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{loc.except}" itemValue="false" />
                            <f:selectItem itemLabel="#{loc.inclusive}" itemValue="true"/>
                        </p:selectOneMenu>

                    </h:panelGroup> 
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-6">
                    <p:outputLabel value="#{loc.pricelist}" for="slcPriceList" class="Fs12 FontBold"/>
                    <p:selectOneMenu id="slcPriceList" value="#{discountDiscountTabBean.selectedObject.priceList.id}" > 
                        <f:selectItem itemLabel="#{loc.choose}" itemValue="0" />
                        <f:selectItems value="#{discountDiscountTabBean.listOfPriceList}" var="pricelist" itemLabel="#{pricelist.name}" itemValue="#{pricelist.id}"/>
                        <p:ajax global="false" update="pgrDiscount pngTax" listener="#{discountDiscountTabBean.selectedObject.setDiscountAmount(null)}"/>
                        <p:ajax global="false" update="pgrDiscount pngTax" listener="#{discountDiscountTabBean.selectedObject.setDiscountRate(null)}"/>
                        <p:ajax global="false" listener="#{discountDiscountTabBean.bringPriceList()}" />
                    </p:selectOneMenu>
                </div>
                <h:panelGroup rendered="true">
                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.salecount}" for="txtSaleCount" styleClass="Fs12 FontBold"/>
                        <p:inputNumber  id="txtSaleCount" value="#{discountDiscountTabBean.selectedObject.saleCount}" placeholder="#{loc.salecount}" minValue="1"
                                        roundMethod="D" decimalPlaces="0"
                                        >
                                         
                            <p:keyFilter regEx="/[0-9]/"/>
                        </p:inputNumber>
                    </div>
                </h:panelGroup>
                <h:panelGroup rendered="true">
                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.startdate}" for="cldStartDate" styleClass="Fs12 FontBold"/>
                        <p:calendar  id="cldStartDate" value="#{discountDiscountTabBean.selectedObject.beginDate}" beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat}" showOn="button" showButtonPanel="true" placeholder="#{loc.startdate}" mask="true" navigator="true" locale="#{sessionBean.locale}" yearRange="c-100:c+20" >
                            <p:ajax event="dateSelect" update="cldEndDate" global="false"/>
                            <p:ajax event="change" update="cldStartDate" resetValues="true" global="false"/>
                        </p:calendar>     
                    </div>
                </h:panelGroup>
                <h:panelGroup rendered="true">
                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.enddate}" for="cldEndDate" styleClass="Fs12 FontBold"/>
                        <p:calendar  id="cldEndDate" value="#{discountDiscountTabBean.selectedObject.endDate}" required="#{discountDiscountTabBean.selectedObject.beginDate!=null}" beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat}" showOn="button" showButtonPanel="true" placeholder="#{loc.enddate}" mask="true" navigator="true" locale="#{sessionBean.locale}" yearRange="c-100:c+20" >
                            <p:ajax event="change" update="cldEndDate" resetValues="true" global="false"/>
                            <f:validator validatorId="dateRangeValidator" />
                            <f:attribute name="startDate" value="#{discountDiscountTabBean.selectedObject.beginDate}" />
                        </p:calendar>     
                    </div>
                </h:panelGroup>
                <h:panelGroup rendered="true">
                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.starttime}"  class="Fs12 FontBold"/>
                        <p:calendar class="limitCalendar" value="#{discountDiscountTabBean.selectedObject.beginTime}" pattern="HH:mm" timeOnly="true" timeControlType="select" placeholder="#{loc.starttime}" locale="#{sessionBean.locale}">
                            <p:ajax global="false"/>
                        </p:calendar>
                    </div>

                </h:panelGroup>
                <h:panelGroup rendered="true">
                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.endtime}"  class="Fs12 FontBold"/>
                        <p:calendar class="limitCalendar" value="#{discountDiscountTabBean.selectedObject.endTime}" required="#{discountDiscountTabBean.selectedObject.beginTime!=null}" pattern="HH:mm" timeOnly="true" timeControlType="select" locale="#{sessionBean.locale}"  placeholder="#{loc.endtime}"/>
                    </div>
                </h:panelGroup>

                <div class="ui-g-12 ui-md-6 ui-lg-6">
                    <p:outputLabel value="#{loc.startamount}"  styleClass="Fs12 FontBold"/>
                    <p:inputText id="txtStartAmount" value="#{discountDiscountTabBean.selectedObject.beginPrice}"
                                 class="Wid90 TexAlRight"  placeholder="#{loc.startamount}" >                 
                        <p:ajax global="false" update=""/>
                        <p:keyFilter regEx="/[0-9]/"/>
                    </p:inputText>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-6">
                    <p:outputLabel value="#{loc.endamount}"  styleClass="Fs12 FontBold"/>
                    <p:inputText id="txtEndAmount" 
                                 value="#{discountDiscountTabBean.selectedObject.endPrice}"  class="Wid90 TexAlRight" placeholder="#{loc.endamount}" >                 
                        <p:keyFilter regEx="/[0-9]/"/>
                        <p:ajax global="false" update=""/>
                    </p:inputText>
                </div>


                <div class="ui-g-12 ui-md-6 ui-lg-6">
                    <p:outputLabel value="#{loc.necessarystock}" for="txtStockNecessary" styleClass="Fs12 FontBold"/>
                    <p:inputText id="txtStockNecessary" value="#{discountDiscountTabBean.selectedNecessaryStockCount}" onclick="showStockBookNecessary()" class="inputPositionForBookFilter" readonly="#{facesContext.currentPhaseId.ordinal ge 4}" placeholder="#{loc.choose}" >

                    </p:inputText>
                    <p:commandLink id="btnStockNecessary" process="@this"  actionListener="#{discountDiscountTabBean.openDialog(false)}" class="commandLinkPositionForBookFilter" oncomplete="PF('olp_stockcheckbox').show();">
                        <i class="fa fa-book Fs16 iconPositionForBookFilter"></i>     
                        <p:ajax   listener="#{stockBookCheckboxFilterBean.findFilterListLazyLoading([],'frmStockBookFilterCheckbox','olp_stockcheckbox','discountitem')}" update="frmStockBookFilterCheckbox" />
                    </p:commandLink>
                </div>


                <div class="ui-g-12 ui-md-6 ui-lg-6">
                    <p:outputLabel value="#{loc.promotionstock}" for="txtStockPromotion" styleClass="Fs12 FontBold"/>
                    <p:inputText id="txtStockPromotion" value="#{discountDiscountTabBean.selectedPromotionStockCount}" onclick="showStockBookPromotion()" class="inputPositionForBookFilter" readonly="#{facesContext.currentPhaseId.ordinal ge 4}" placeholder="#{loc.choose}" >

                    </p:inputText>
                    <p:commandLink id="btnStockPromotion" process="@this" update="frmStockBookFilterCheckbox" actionListener="#{discountDiscountTabBean.openDialog(true)}" class="commandLinkPositionForBookFilter" oncomplete="PF('olp_stockcheckbox').show();">
                        <i class="fa fa-book Fs16 iconPositionForBookFilter"></i>
                        <p:ajax   listener="#{stockBookCheckboxFilterBean.findFilterListLazyLoading([],'frmStockBookFilterCheckbox','olp_stockcheckbox','discountitem')}" update="frmStockBookFilterCheckbox" />
                    </p:commandLink>
                </div>


                <h:panelGroup rendered="true">
                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.necessarybrand}" for="slcNecessaryBrand" class="Fs12 FontBold"/>
                        <p:selectCheckboxMenu  id="slcNecessaryBrand" converter="entityConverter" value="#{discountDiscountTabBean.selectedObject.necessaryBrandList}" filter="true"  
                                               filterMatchMode="contains" widgetVar="slc_brandNecessaryCheckBox"  
                                               label="#{discountDiscountTabBean.selectedObject.necessaryBrandList.size()!=0 ? discountDiscountTabBean.selectedObject.necessaryBrandList.size() :loc.choose} #{discountDiscountTabBean.selectedObject.necessaryBrandList.size()!=0 ? loc.brand : ''} #{discountDiscountTabBean.selectedObject.necessaryBrandList.size()!=0 ? loc.selected : ''}" styleClass="Wid90" >
                            <f:selectItems value="#{discountDiscountTabBean.listOfBrand}" itemLabel="#{brand.name}" itemValue="#{brand}" var="brand" />       
                            <p:ajax update="slcNecessaryBrand  " oncomplete="PF('slc_brandNecessaryCheckBox').show()" global="false"/>
                            <p:ajax event="toggleSelect" update="slcNecessaryBrand" oncomplete="PF('slc_brandNecessaryCheckBox').show()" global="false"/>
                        </p:selectCheckboxMenu>
                    </div>

                </h:panelGroup>

                <h:panelGroup rendered="true">
                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.promotionbrand}" for="slcPromotionBrand" class="Fs12 FontBold"/>
                        <p:selectCheckboxMenu  id="slcPromotionBrand" converter="entityConverter" value="#{discountDiscountTabBean.selectedObject.promotionBrandList}" filter="true" 
                                               filterMatchMode="contains" widgetVar="slc_brandPromotionCheckBox"  
                                               label="#{discountDiscountTabBean.selectedObject.promotionBrandList.size()!=0 ? discountDiscountTabBean.selectedObject.promotionBrandList.size() :loc.choose} #{discountDiscountTabBean.selectedObject.promotionBrandList.size()!=0 ? loc.brand : ''} #{discountDiscountTabBean.selectedObject.promotionBrandList.size()!=0 ? loc.selected : ''}" styleClass="Wid90" >
                            <f:selectItems value="#{discountDiscountTabBean.listOfBrand}" itemLabel="#{brand.name}" itemValue="#{brand}" var="brand" />       
                            <p:ajax update="slcPromotionBrand  " oncomplete="PF('slc_brandPromotionCheckBox').show()" global="false"/>
                            <p:ajax event="toggleSelect" update="slcPromotionBrand" oncomplete="PF('slc_brandPromotionCheckBox').show()" global="false"/>
                        </p:selectCheckboxMenu>
                    </div>

                </h:panelGroup>

                <h:panelGroup rendered="true">

                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.days}" for="slcDay" class="Fs12 FontBold"/>
                        <p:selectCheckboxMenu id="slcDay" widgetVar="slc_days" value="#{discountDiscountTabBean.selectedObject.specialDays}"
                                              label="#{discountDiscountTabBean.selectedObject.specialDays.size()!=0 ? discountDiscountTabBean.selectedObject.specialDays.size() : loc.days} #{discountDiscountTabBean.selectedObject.specialDays.size()!=0 ? loc.selected : ''}" filter="true" filterMatchMode="contains" >
                            <f:selectItems value="#{discountDiscountTabBean.listOfDays}"/>
                            <p:ajax update="slcDay" oncomplete="PF('slc_days').show()" global="false"/>
                            <p:ajax event="toggleSelect" update="slcDay" oncomplete="PF('slc_days').show()" global="false"/>
                        </p:selectCheckboxMenu>
                    </div>
                </h:panelGroup>
                <h:panelGroup rendered="true">
                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.months}" for="slcMonths" class="Fs12 FontBold"/>
                        <p:selectCheckboxMenu id="slcMonths" widgetVar="slc_months" value="#{discountDiscountTabBean.selectedObject.specialMonths}"
                                              label="#{discountDiscountTabBean.selectedObject.specialMonths.size()!=0 ? discountDiscountTabBean.selectedObject.specialMonths.size() : loc.months} #{discountDiscountTabBean.selectedObject.specialMonths.size()!=0 ? loc.selected : ''}"
                                              filter="true"  filterMatchMode="contains">
                            <f:selectItems value="#{discountDiscountTabBean.listOfMonths}"/>
                            <p:ajax update="slcMonths" oncomplete="PF('slc_months').show()" global="false"/>
                            <p:ajax event="toggleSelect" update="slcMonths" oncomplete="PF('slc_months').show()" global="false"/>
                        </p:selectCheckboxMenu>
                    </div>
                </h:panelGroup>
                <h:panelGroup rendered="true">
                    <div class="ui-g-12 ui-md-6 ui-lg-6">
                        <p:outputLabel value="#{loc.dayofmonth}" for="slcDayOfMonth" class="Fs12 FontBold"/>
                        <p:selectCheckboxMenu id="slcDayOfMonth" widgetVar="slc_DayOfMonth" value="#{discountDiscountTabBean.selectedObject.specialMonthDays}"
                                              label="#{discountDiscountTabBean.selectedObject.specialMonthDays.size()!=0 ? discountDiscountTabBean.selectedObject.specialMonthDays.size() : loc.dayofmonth} #{discountDiscountTabBean.selectedObject.specialMonthDays.size()!=0 ? loc.selected : ''}"
                                              filter="true" filterMatchMode="contains">
                            <f:selectItems value="#{discountDiscountTabBean.listOfDaysOfMonth}"/>
                            <p:ajax update="slcDayOfMonth" oncomplete="PF('slc_DayOfMonth').show()" global="false"/>
                            <p:ajax event="toggleSelect" update="slcDayOfMonth" oncomplete="PF('slc_DayOfMonth').show()" global="false"/>
                        </p:selectCheckboxMenu>

                    </div>
                </h:panelGroup>

                <!-- <h:panelGroup rendered="true">
                     <div class="ui-g-12 ui-md-6 ui-lg-6">
                         <p:outputLabel value="#{loc.discountcode}" for="slcDiscountCoupon" class="Fs12 FontBold"/>
                         <p:selectOneMenu id="slcDiscountCoupon" value="#{discountDiscountTabBean.selectedObject.isDiscountCode}" class="Wid95"> 
                             <f:selectItem itemLabel="#{loc.choose}" itemValue="0" itemDisabled="true"/> 
                             <f:selectItem itemLabel="#{loc.yes}" itemValue="true"/>
                             <f:selectItem itemLabel="#{loc.no}" itemValue="false"/>
                         </p:selectOneMenu>
                     </div>
                 </h:panelGroup>-->
            </div>
        </h:panelGroup>


        <p:remoteCommand name="showStockBookNecessary" process="@this" update="frmStockBookFilterCheckbox " oncomplete="PF('olp_stockcheckbox').loadContents();" action="#{discountDiscountTabBean.openDialog(false)}" actionListener="#{stockBookCheckboxFilterBean.findFilterListLazyLoading([],'frmStockBookFilterCheckbox','olp_stockcheckbox','discountitem')}" />
        <p:remoteCommand name="showStockBookPromotion" process="@this" update="frmStockBookFilterCheckbox" oncomplete="PF('olp_stockcheckbox').loadContents();" action="#{discountDiscountTabBean.openDialog(true)}" actionListener="#{stockBookCheckboxFilterBean.findFilterListLazyLoading([],'frmStockBookFilterCheckbox','olp_stockcheckbox','discountitem')}" />

    </h:form>






</ui:composition>
