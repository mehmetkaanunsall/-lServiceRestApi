<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">


    <div class="ContainerIndent"> 

        <ui:include src="/pages/general/common/datagridtoolbardefinition.xhtml" >
            <ui:param name="bean" value="#{orderItemTabBean}"/>   <!-- Bean -->
            <ui:param name="update" value="dlgStockProcess"/>  <!-- Yeni butonuna basınca açılacak sayfa  -->
            <ui:param name="btnNewId" value="#{orderItemTabBean.selectedOrder.type.id!=102 and (orderItemTabBean.selectedOrder.status.id==59 or orderItemTabBean.selectedOrder.status.id==66) ?  orderItemTabBean.getRendered(338, 0) : false}"/>  <!-- buton id yetki kontrolü için  -->
            <ui:param name="datatable" value="tbvOrder:frmOrderItem:dtbOrderItem" />  <!-- datatable  -->       
            <ui:param name="widgetvar" value='orderItemPF' />
            <ui:param name="form" value='frmToolbarOrderItem' />
            <ui:param name="fileName" value="#{loc.orders}"/> 
            <ui:param name="renderedToggler" value='true'/>       
            <ui:param name="renderedExel" value='true'/>
            <ui:param name="renderedPdf" value='true'/>
            <ui:param name="renderedOrderQuantity" value='#{orderItemTabBean.selectedOrder.status.id==59 or orderItemTabBean.selectedOrder.status.id==66}'/>          
            <ui:param name="renderedSave" value='#{(orderItemTabBean.selectedOrder.status.id==59 or orderItemTabBean.selectedOrder.status.id==66) and  orderItemTabBean.getRendered(334, 0)}'/>
        </ui:include>

        <h:form id="frmOrderItem" >

            <p:dataTable  id="dtbOrderItem" var="OrderItem"  value="#{orderItemTabBean.listOfObjects}" filteredValue="#{orderItemTabBean.listOfFilteredObjects}" editable="true" editMode="cell" widgetVar="orderItemPF" selection="#{orderItemTabBean.selectedObject}" selectionMode="single" emptyMessage="#{loc.norecordsfound}"
                          rows="#{sessionBean.user.defualtGridSize}" rowKey="#{OrderItem.stock.id}" paginator="true" paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {CurrentPageReport}"
                          rowsPerPageTemplate="#{sessionBean.user.gridSize}" paginatorPosition="bottom" currentPageReportTemplate="{startRecord}-{endRecord} #{loc.intotal} {totalRecords}"  reflow="true" >
                <p:ajax event="page" global="false"/>
                <p:ajax event="filter" global="false"/>

                <f:facet  name="footer"     >
                    <p:inputText id="globalFilter" value="#{orderItemTabBean.autoCompleteValue}"  style="display: none" />
                </f:facet>



                <p:column id="clmBarcode" headerText="#{loc.barcode}"  sortable="true" sortBy="#{OrderItem.stock.barcode}" filterable="true"  filterBy="#{OrderItem.stock.barcode}" filterMatchMode="contains" visible="#{orderItemTabBean.toogleList[0]}" exportable="#{orderItemTabBean.toogleList[0]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.stock.barcode}" />
                </p:column>

                <p:column id="clmStock" headerText="#{loc.stock}" sortable="true" sortBy="#{OrderItem.stock.name}" filterable="true"  filterBy="#{OrderItem.stock.name}" visible="#{orderItemTabBean.toogleList[1]}" exportable="#{orderItemTabBean.toogleList[1]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.stock.name}" />
                </p:column>

                <p:column id="clmBoxQuantity" headerText="#{loc.boxquantity}" sortable="true" sortBy="#{OrderItem.boxQuantity}" filterable="true"  filterBy="#{OrderItem.boxQuantity}" visible="#{orderItemTabBean.toogleList[2]}" exportable="#{orderItemTabBean.toogleList[2]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.boxQuantity}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="unit" value="#{OrderItem.unit}"/>
                        <f:attribute name="type" value="unit" />
                    </h:outputText>
                </p:column>

                <p:column id="clmShelfQuantity" headerText="#{loc.requiredamounttofilltheshelf}" sortable="true" sortBy="#{OrderItem.shelfQuantity}" filterable="true"  filterBy="#{OrderItem.shelfQuantity}" visible="#{orderItemTabBean.toogleList[3]}" exportable="#{orderItemTabBean.toogleList[3]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.shelfQuantity}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="unit" value="#{OrderItem.unit}"/>
                        <f:attribute name="type" value="unit" />
                    </h:outputText>
                </p:column>

                <p:column id="clmRequiredWarehouseStock" headerText="#{loc.requiredwarehousestock}" sortable="true" sortBy="#{OrderItem.requiredWarehouseStock}" filterable="true"  filterBy="#{OrderItem.requiredWarehouseStock}" visible="#{orderItemTabBean.toogleList[4]}" exportable="#{orderItemTabBean.toogleList[4]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.requiredWarehouseStock}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>

                <p:column id="clmRequiredTotalStock" headerText="#{loc.requiredtotalstock}" sortable="true" sortBy="#{OrderItem.requiredTotalStock}" filterable="true"  filterBy="#{OrderItem.requiredTotalStock}" visible="#{orderItemTabBean.toogleList[5]}" exportable="#{orderItemTabBean.toogleList[5]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.requiredTotalStock}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>

                <p:column id="clmTotalNumberofStock" headerText="#{loc.totalnumberofstock}" sortable="true" sortBy="#{OrderItem.warehouseQuantity}" filterable="true"  filterBy="#{OrderItem.warehouseQuantity}" visible="#{orderItemTabBean.toogleList[6]}" exportable="#{orderItemTabBean.toogleList[6]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.warehouseQuantity}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>

                <p:column id="clmLastTwoMonthSales" headerText="#{loc.lasttwomonthssales}" sortable="true" sortBy="#{OrderItem.lastTwoMonthsSales}" filterable="true"  filterBy="#{OrderItem.lastTwoMonthsSales}" visible="#{orderItemTabBean.toogleList[7]}" exportable="#{orderItemTabBean.toogleList[7]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.lastTwoMonthsSales}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>
                <p:column id="clmLastTwoMonthSalesActiveDay" headerText="#{loc.lasttwomonthsaledays}" sortable="true" sortBy="#{OrderItem.twoMonthSaleActiveDay}" visible="#{orderItemTabBean.toogleList[8]}" exportable="#{orderItemTabBean.toogleList[8]}" >
                    <h:outputText value="#{OrderItem.twoMonthSaleActiveDay}" class="Fright"/>
                </p:column>
                <p:column id="clmAverageWeeklyOrderQuantityForDaysCount" headerText="#{loc.averageweeklysalesaccordingtoday}" sortable="true" sortBy="#{OrderItem.averageWeeklyOrderQuantityForDaysCount}" visible="#{orderItemTabBean.toogleList[9]}" exportable="#{orderItemTabBean.toogleList[9]}" >

                    <h:outputText value="#{OrderItem.averageWeeklyOrderQuantityForDaysCount}" class="Fright"/>
                </p:column>
                <p:column id="clmAverageWeeklyOrderQuantity" headerText="#{loc.averageweeklyorderquantity}" sortable="true" sortBy="#{OrderItem.averageWeeklyOrderQuantity}" filterable="true"  filterBy="#{OrderItem.averageWeeklyOrderQuantity}" visible="#{orderItemTabBean.toogleList[10]}" exportable="#{orderItemTabBean.toogleList[10]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.averageWeeklyOrderQuantity}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>
                <p:column id="clmStockEnoughDay" headerText="#{loc.stockenoughday}" sortable="true" sortBy="#{OrderItem.stockEnoughDay}" filterable="true"  filterBy="#{OrderItem.stockEnoughDay}" visible="#{orderItemTabBean.toogleList[11]}" exportable="#{orderItemTabBean.toogleList[11]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.stockEnoughDay}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>
                <p:column id="clmOrderCalculationSupplement" headerText="#{loc.ordercalculationsupplement}" sortable="true" sortBy="#{OrderItem.orderCalculationSupplement}" filterable="true"  filterBy="#{OrderItem.orderCalculationSupplement}" visible="#{orderItemTabBean.toogleList[12]}" exportable="#{orderItemTabBean.toogleList[12]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.orderCalculationSupplement}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>
                <p:column id="clmMinQuantity" headerText="#{loc.minorderquantity}" sortable="true" sortBy="#{OrderItem.minQuantity}" filterable="true"  filterBy="#{OrderItem.minQuantity}" visible="#{orderItemTabBean.toogleList[13]}" exportable="#{orderItemTabBean.toogleList[13]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.minQuantity}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>
                <p:column id="clmMaxQuantity" headerText="#{loc.maxorderquantity}" sortable="true" sortBy="#{OrderItem.maxQuantity}" filterable="true"  filterBy="#{OrderItem.maxQuantity}" visible="#{orderItemTabBean.toogleList[14]}" exportable="#{orderItemTabBean.toogleList[14]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.maxQuantity}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>
                
                <p:column id="clmProductReaminingAmount" headerText="#{loc.remainingamount}" sortable="true" sortBy="#{OrderItem.remainingQuantity}" filterable="true"  filterBy="#{OrderItem.remainingQuantity}" visible="#{orderItemTabBean.toogleList[15]}" exportable="#{orderItemTabBean.toogleList[15]}" >
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.remainingQuantity==null?0:OrderItem.remainingQuantity}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>
                
                <p:column id="clmQuantity" headerText="#{loc.orderquantity}" sortable="true" sortBy="#{OrderItem.quantity}" filterable="true"  filterBy="#{OrderItem.quantity}" visible="#{orderItemTabBean.toogleList[16]}" exportable="#{orderItemTabBean.toogleList[16]}" >

                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    
                    <h:outputText rendered="#{orderItemTabBean.selectedOrder.status.id!=59 and orderItemTabBean.selectedOrder.status.id!=66}" value="#{OrderItem.quantity}" class="Fright">
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="type" value="" />
                    </h:outputText>

                    <p:cellEditor id="ceQuantity"  rendered="#{orderItemTabBean.selectedOrder.status.id==59 or orderItemTabBean.selectedOrder.status.id==66}">
                        <f:facet name="output">
                            <h:outputText value="#{OrderItem.quantity}" class="Fright">
                                <f:converter converterId="currencyConverter" />
                                <f:attribute name="type" value="" />
                            </h:outputText>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputNumber value="#{OrderItem.quantity}"  class="editableinput"
                                           decimalSeparator="#{sessionBean.user.lastBranch.decimalsymbol ==1 ? '.': ','}"  minValue="0"
                                           thousandSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1 ? ',': '.'}"
                                           decimalPlaces="#{sessionBean.user.lastBranch.currencyrounding}"
                                           roundMethod="D" emptyValue="">
                                <p:ajax listener="#{orderItemTabBean.changeItemQuantity(OrderItem)}"/>
                            </p:inputNumber> 
                        </f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column id="clmDescription" headerText="#{loc.description}" sortable="true" sortBy="#{OrderItem.description}" filterable="true"  filterBy="#{OrderItem.description}" visible="#{orderItemTabBean.toogleList[17]}" exportable="#{orderItemTabBean.toogleList[17]}" >

                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet> 
                    <h:outputText value="#{OrderItem.description}">
                    </h:outputText>
                    <p:commandLink id="btnDescription" class="Fright" actionListener="#{orderItemTabBean.setSelectedOrderItemForDescription(OrderItem)}"  oncomplete="PF('dlg_description').show()" update="dlgDescription" resetValues="true"  process="@this">
                        <i class="fa fa-edit Fs15 "/> 
                    </p:commandLink>
                    
                </p:column>



            </p:dataTable>  

        </h:form>
    </div>



</ui:composition>
