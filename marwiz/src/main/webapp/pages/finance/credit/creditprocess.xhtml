<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions" 
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">


    <h:form id="frmCreditProcess">
        <ui:include src="/pages/general/common/processtoolbar.xhtml" >
            <ui:param name="outputtext" value="#{loc.creditprocess}"/>
            <ui:param name="bean" value='#{creditProcessBean}' />
            <ui:param name="update" value="pgrCreditProcess" />
            <ui:param name="btnSaveId" value='false' />     
            <ui:param name="renderback" value='true'/>
            <ui:param name="renderSelectedObject" value='true'/>
            <ui:param name="selectedObjectName" value="#{creditProcessBean.selectedObject.account.name}"/>
            <ui:param name="btnDeleteId" value='#{creditProcessBean.getRendered(21, 0)}' />
            <ui:param name="btnTestBeforeDeleteId" value="true" />
        </ui:include>

        <h:panelGroup id="pgrCreditProcess" layout="block">
            <div class="ui-g divContent">
                <div class="ui-g panelToggle">
                    <p:focus for="txtCreditDate"/>
                    <h:panelGroup rendered="#{creditProcessBean.listOfBranch.size() > 1}">
                        <div class="ui-g-12 ui-md-2">
                            <p:outputLabel value="#{loc.branch}" for="slcBranch" styleClass="Fs12 FontBold"/>
                            <p:selectOneMenu id="slcBranch" value="#{creditProcessBean.selectedObject.branchSetting.branch.id}" disabled="true">
                                <f:selectItem itemValue="#{null}" itemLabel="#{loc.choose}" itemDisabled="true"/>
                                <f:selectItems value="#{creditProcessBean.listOfBranch}" var="branchSetting" itemValue="#{branchSetting.branch.id}" itemLabel="#{branchSetting.branch.name}" />
                            </p:selectOneMenu>
                        </div>
                    </h:panelGroup>
                    <div class="#{creditProcessBean.listOfBranch.size() > 1 ? 'ui-g-12  ui-md-2' : 'ui-g-12  ui-md-4'}">
                        <p:outputLabel value="#{loc.creditdate}" for="txtCreditDate" class="FontBold Fs12"/>
                        <p:inputText id="txtCreditDate" value="#{creditProcessBean.selectedObject.processDate}" required="true" placeholder="#{loc.creditdate}" readonly="true">
                            <f:convertDateTime pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm:ss"/>
                        </p:inputText>
                    </div>

                    <div class="#{creditProcessBean.listOfBranch.size() > 1 ? 'ui-g-12  ui-md-4' : 'ui-g-12  ui-md-4'}">
                        <p:outputLabel value="#{loc.customername}" for="txtCustomerName" class="FontBold Fs12"/>
                        <p:inputText id="txtCustomerName" value="#{creditProcessBean.selectedObject.account.name}" required="true" placeholder="#{loc.customername}" readonly="true"/>  
                    </div>

                    <div class="#{creditProcessBean.listOfBranch.size() > 1 ? 'ui-g-12  ui-md-2' : 'ui-g-12  ui-md-4'}">
                        <p:outputLabel value="#{loc.creditamount}" for="txtCreditAmount" class="FontBold Fs12"/>
                        <p:inputText id="txtCreditAmount" value="#{creditProcessBean.selectedObject.money}" required="true" placeholder="#{loc.creditamount}" readonly="true">
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="currency" value="#{creditProcessBean.selectedObject.currency}"/>
                            <f:attribute name="type" value="currency" />
                        </p:inputText>
                    </div>

                    <div class="#{creditProcessBean.listOfBranch.size() > 1 ? 'ui-g-12  ui-md-2' : 'ui-g-12  ui-md-4'}">
                        <p:outputLabel value="#{loc.paymentdate}" for="txtDueDate" class="FontBold Fs12"/>
                        <p:inputText id="txtDueDate" value="#{creditProcessBean.selectedObject.dueDate}" required="true" placeholder="#{loc.paymentdate}" readonly="true">  
                            <f:convertDateTime pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm:ss"/>
                        </p:inputText>
                    </div>

                    <div class="ui-g-12  ui-md-4">
                        <p:outputLabel value="#{loc.remainingamountt}" for="txtRemainingAmount" class="FontBold Fs12"/>
                        <p:inputText id="txtRemainingAmount" value="#{creditProcessBean.selectedObject.remainingMoney}" required="true" placeholder="#{loc.remainingamount}" readonly="true">
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="currency" value="#{creditProcessBean.selectedObject.currency}"/>
                            <f:attribute name="type" value="currency" />
                        </p:inputText>
                    </div>

                    <div class="ui-g-12  ui-md-2">
                        <p:outputLabel value="#{loc.statu}" for="txtStatu" class="FontBold Fs12"/>
                        <p:inputText id="txtStatu" value="#{creditProcessBean.selectedObject.isPaid==true ? loc.itwaspaid :loc.unpaid}" required="true" placeholder="#{loc.statu}" readonly="true"/>  

                    </div>
                    <div class="ui-g-12  ui-md-2">
                        <p:outputLabel value="#{loc.documentedstatus}" for="txtDocumentStatu" class="FontBold Fs12"/>
                        <p:inputText id="txtDocumentStatu" value="#{creditProcessBean.selectedObject.isInvoice==true ? loc.documented :loc.undocumented}" required="true" placeholder="#{loc.documentedstatus}" readonly="true"/>  

                    </div>

                </div>
            </div>
        </h:panelGroup>
        <p:remoteCommand name="goToRelatedRecord" actionListener="#{creditPaymentTabBean.goToRelatedRecord()}" delay="200"/>
        <p:remoteCommand name="rcgoToRelatedRecord" actionListener="#{creditProcessBean.goToRelatedRecord()}" delay="500" process="@this"/>

    </h:form>
    <div class="EmptyBox10"></div>

    <p:tabView id="tbvCredit" activeIndex="#{marwiz.tabIndex}" rendered="#{creditProcessBean.getRendered(7, 1)}" scrollable="true" dynamic="true" cache="true">
        <p:ajax event="tabChange" listener="#{creditProcessBean.onTabChange}" />

        <p:tab id="tab7" title="#{creditProcessBean.selectedObject.isCustomer==true?loc.collectionprocess:loc.creditpayments}" rendered="#{creditProcessBean.getRendered(7, 1)}">
            <c:if test="#{creditProcessBean.activeIndex==7}" >
                <ui:include src="/pages/finance/credit/creditpaymenttab.xhtml"/>
            </c:if>
        </p:tab>
    </p:tabView>


    <p:dialog id="dlgCreditPaymentProcess" widgetVar="dlg_CreditPaymentProcess" resizable="false" focus="dlgCreditPaymentProcess" responsive="true" dynamic="true" modal="true" closeOnEscape="true" width="65%" >
        <c:if test="#{creditProcessBean.activeIndex==7}" >
            <ui:include src="creditpaymentprocess.xhtml"/>
        </c:if>
    </p:dialog> 
    
    
     <p:confirmDialog id="dlgRelatedRecordInfoProcess"  class="deleteConfirm controlDelete"  widgetVar="dlg_RelatedRecordInfoProcess" closable="true" width="30%" responsive="true">
        <f:facet name="message">
            <p:panel class="divContent">
                <div class="ui-g">
                    <div class="ui-g-12 ui-md-12 ui-lg-12">
                        <h:outputText value="#{creditProcessBean.deleteControlMessage}" />
                    </div>
                    <div class="ui-g-12 ui-md-12 ui-lg-12">
                        <h:outputText value="#{creditProcessBean.deleteControlMessage1}" />
                    </div>
                    <div class="ui-g-12 ui-md-12 ui-lg-6">
                        <h:outputText value="#{creditProcessBean.deleteControlMessage2}" class="Fright"/>
                    </div>
                    <div class="ui-g-12 ui-md-12 ui-lg-6">
                        <p:commandLink value="#{creditProcessBean.relatedRecord}" class="Fleft cmdRelatedRecord" title="#{loc.gotorelatedrecord}" actionListener="#{creditProcessBean.goToRelatedRecordBefore()}" />
                    </div>
                    <h:panelGroup rendered="#{creditProcessBean.isDeleteButton}">
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <p:commandButton value="#{loc.yes}" action="#{creditProcessBean.delete()}" onclick="PF('dlg_RelatedRecordInfoProcess').hide()" process="@this" styleClass="ui-confirmdialog-yes" icon="ui-icon-check fa fa-check Fs14 white"   />
                        </div>
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <p:commandButton value="#{loc.no}" type="button" onclick="PF('dlg_RelatedRecordInfoProcess').hide()" styleClass="ui-confirmdialog-no" icon="ui-icon-close fa fa-close Fs14 white" />
                        </div>
                    </h:panelGroup>
                </div>
            </p:panel>
        </f:facet>
    </p:confirmDialog>


    <p:confirmDialog id="dlgRelatedRecordInfo"  class="deleteConfirm controlDelete"  widgetVar="dlg_RelatedRecordInfo" closable="true" width="20%" responsive="true">
        <c:if test="#{creditProcessBean.activeIndex==7}" >
            <f:facet name="message">
                <p:panel class="divContent">
                    <div class="ui-g">
                        <div class="ui-g-12 ui-md-12 ui-lg-12">
                            <h:outputText value="#{creditPaymentTabBean.deleteControlMessage}" />
                        </div>
                        <div class="ui-g-12 ui-md-12 ui-lg-12">
                            <h:outputText value="#{creditPaymentTabBean.deleteControlMessage1}"/>
                        </div>
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <h:outputText value="#{creditPaymentTabBean.deleteControlMessage2}" class="Fright"/>
                        </div>
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <p:commandLink value="#{creditPaymentTabBean.relatedRecord}" class="Fleft cmdRelatedRecord" title="#{loc.gotorelatedrecord}" actionListener="#{creditPaymentTabBean.goToRelatedRecordBefore()}"/>
                        </div>
                        <div class="EmptyBox10"/>
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <p:commandButton value="#{loc.yes}" actionListener="#{creditPaymentTabBean.delete()}" async="true" global="true" onclick="PF('dlg_RelatedRecordInfo').hide()"   styleClass="ui-confirmdialog-yes" icon="ui-icon-check fa fa-check Fs14 white"   />
                        </div>
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <p:commandButton value="#{loc.no}"  onclick="PF('dlg_RelatedRecordInfo').hide()" styleClass="ui-confirmdialog-no" icon="ui-icon-close fa fa-close Fs14 white" />
                        </div>
                    </div>
                </p:panel>
            </f:facet>
        </c:if>
    </p:confirmDialog>

    <p:confirmDialog global="true" class="deleteConfirm MaxWid500"   id="dlgConfirmation" widgetVar="dlgConfirmationVar" closeOnEscape="true" responsive="true"   >
        <f:facet name="message">
            <div>
                <h:outputText value="#{loc.collectioncannotbemadebecausethisrecordisnotbilled}" style="white-space: pre-wrap;">
                    <i class="icon-trash Fs20 tlbrDeleteBtn" /> 
                </h:outputText>
            </div>

            <div>
                <h:outputText value="#{loc.doyouwanttobillnow}">
                    <i class="icon-trash Fs20 tlbrDeleteBtn" /> 
                </h:outputText>
            </div>

        </f:facet>      
        <p:commandButton  action="#{creditProcessBean.gotoInvoice()}"  onclick="PF('dlgConfirmationVar').hide()"    process="@this"  value="#{loc.yes}"   styleClass="ui-confirmdialog-yes" icon="ui-icon-check fa fa-check Fs14 white"   />
        <p:commandButton value="#{loc.no}"   type="button" onclick="PF('dlgConfirmationVar').hide()" styleClass="ui-confirmdialog-no" icon="ui-icon-close fa fa-close Fs14 white" />
    </p:confirmDialog>
    
     

</ui:composition>

