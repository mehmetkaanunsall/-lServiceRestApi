<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <h:form id="frmFinancingDocumentAccountProcess">
        <ui:include src="/pages/general/common/processtoolbar.xhtml" >
            <ui:param name="outputtext" value="#{loc.fromcustomertocustomertransaction}"/>
            <ui:param name="bean" value='#{customerToCustomerTransferBean}' />
            <ui:param name="update" value="pgrFinancingDocumentProcess" />
            <ui:param name="btnSaveId" value="true" />     
            <ui:param name="renderback" value='false'/>
            <ui:param name="btnEditId" value="false"/>
        </ui:include>

        <h:panelGroup id="pgrFinancingDocumentProcess" layout="block" class="divContent">
            <div class="ui-g">
                <h:panelGroup rendered="#{accountMovementTabBean.listOfBranch.size() > 1}">
                    <div class="ui-g-12 ui-md-2">
                        <p:outputLabel value="#{loc.branch}" for="slcBranch" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcBranch" value="#{customerToCustomerTransferBean.customerToCustomer.branch.id}">
                            <f:selectItem itemValue="#{null}" itemLabel="#{loc.choose}" itemDisabled="true"/>
                            <f:selectItems value="#{accountMovementTabBean.listOfBranch}" var="branch" itemValue="#{branch.id}" itemLabel="#{branch.name}" />
                            <p:ajax update="pgrFinancingDocumentProcess" listener="#{customerToCustomerTransferBean.changeBranch()}" process="@this"/>
                        </p:selectOneMenu>
                    </div>
                </h:panelGroup>
                <!--İşlem Tipi-->
                <h:panelGroup>
                    <div  class="#{accountMovementTabBean.listOfBranch.size() > 1 ? 'ui-g-12 ui-md-2' : 'ui-g-12 ui-md-3'}">
                        <p:outputLabel value="#{loc.operationtype}" for="slcOperationType" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcOperationType" value="#{customerToCustomerTransferBean.customerToCustomer.financingType.id}" required="true" styleClass="Wid97">
                            <f:selectItem itemLabel="#{loc.choose}" itemValue="0" itemDisabled="true"/> 
                            <f:selectItems value="#{customerToCustomerTransferBean.listOfType}"  var="operationtype" itemLabel="#{operationtype.nameMap.get(sessionBean.langId).name}" itemValue="#{operationtype.id}"  />
                            <p:ajax listener="#{customerToCustomerTransferBean.resetFinancing()}" update="pgrFinancingDocumentProcess" process="@this"/>
                        </p:selectOneMenu>
                    </div>

                    <h:panelGroup rendered="#{customerToCustomerTransferBean.customerToCustomer.financingType.id!=0}">
                        <div  class="#{accountMovementTabBean.listOfBranch.size() > 1 ? 'ui-g-12 ui-md-2' : 'ui-g-12 ui-md-3'}">
                            <p:outputLabel value="1.#{loc.current}" for="txtCurrentName" styleClass="Fs12 FontBold" />
                            <p:inputText id="txtCurrentName" value="#{customerToCustomerTransferBean.customerToCustomer.outAccount.name}" class="inputPositionForBookFilter" required="true" readonly="#{facesContext.currentPhaseId.ordinal ge 4}" rendered="#{facesContext.currentPhaseId.ordinal ne 4}" placeholder="#{loc.currentname} " />
                        </div>
                    </h:panelGroup>

                    <h:panelGroup rendered="#{customerToCustomerTransferBean.customerToCustomer.financingType.id==47 or customerToCustomerTransferBean.customerToCustomer.financingType.id==48}">
                        <div  class="ui-g-12 ui-md-3">
                            <p:outputLabel value="#{loc.safecodename}" for="slcSafe1" styleClass="Fs12 FontBold"/>
                            <p:selectOneMenu id="slcSafe1" value="#{customerToCustomerTransferBean.customerToCustomer.outMovementId}" filter="true" required="true" styleClass="Wid97">
                                <f:selectItem itemLabel="#{loc.choose}" itemValue="0" itemDisabled="true"/> 
                                <f:selectItems value="#{customerToCustomerTransferBean.listOfSafe}" var="safe" itemLabel="#{safe.name} - (#{safe.currency.code})" itemValue="#{safe.id}" itemDisabled="#{!safe.isMposMovement}" />
                                <p:ajax listener="#{customerToCustomerTransferBean.bringCurrency()}" global="false" />
                            </p:selectOneMenu>
                        </div>
                    </h:panelGroup>

                    <h:panelGroup rendered="#{customerToCustomerTransferBean.customerToCustomer.financingType.id==73 or customerToCustomerTransferBean.customerToCustomer.financingType.id==74 or customerToCustomerTransferBean.customerToCustomer.financingType.id==55 or customerToCustomerTransferBean.customerToCustomer.financingType.id==56}">
                        <div  class="ui-g-12 ui-md-3">
                            <p:outputLabel value="#{loc.bankcodename}" for="slcBank" styleClass="Fs12 FontBold"/>
                            <p:selectOneMenu id="slcBank" value="#{customerToCustomerTransferBean.customerToCustomer.outMovementId}"  filter="true"  required="true" styleClass="Wid97">
                                <f:selectItem itemLabel="#{loc.choose}" itemValue="0" itemDisabled="true"/> 
                                <f:selectItems value="#{customerToCustomerTransferBean.listOfBankAccount}" var="bankaccount" itemLabel="#{bankaccount.name} - #{bankaccount.bankBranch.bank.name} - (#{bankaccount.currency.code})" itemValue="#{bankaccount.id}"  />
                                <p:ajax listener="#{customerToCustomerTransferBean.bringCurrency()}" global="false" />
                            </p:selectOneMenu>
                        </div>
                    </h:panelGroup>

                    <h:panelGroup rendered="#{customerToCustomerTransferBean.customerToCustomer.financingType.id!=0}">
                        <div class="ui-g-12 ui-md-3">
                            <p:outputLabel value="2.#{loc.current}" for="txtOutAccount" styleClass="Fs12 FontBold" />
                            <p:inputText id="txtOutAccount" onclick="showAccountBook();" value="#{customerToCustomerTransferBean.customerToCustomer.inAccount.name}" class="inputPositionForBookFilter" required="true" readonly="#{facesContext.currentPhaseId.ordinal ge 4}" rendered="#{facesContext.currentPhaseId.ordinal ne 4}" placeholder="#{loc.accountname} " >
                            </p:inputText>
                            <p:commandLink id="btnOutAccount" class="commandLinkPositionForBookFilter" process="@this"  oncomplete="PF('olp_account').loadContents();" >
                                <i class="fa fa-book Fs16 softgray iconPositionForBookFilter "/>   
                                <p:ajax listener="#{accountBookFilterBean.findFilterListLazyLoading([customerToCustomerTransferBean.customerToCustomer.branch],'frmAccountBookFilter','olp_account','Musteri,MTedatikçi')}" global="false"/>
                            </p:commandLink> 
                        </div>  
                    </h:panelGroup>


                    <h:panelGroup rendered="#{customerToCustomerTransferBean.customerToCustomer.financingType.id!=0}">
                        <div  class="ui-g-12 ui-md-1">
                            <p:outputLabel value="#{loc.documentnumber}" for="txtDocumentNumber" styleClass="Fs12 FontBold" />
                            <p:inputText id="txtDocumentNumber" styleClass="Wid97" placeholder="#{loc.documentnumber}" value="#{customerToCustomerTransferBean.customerToCustomer.documentNumber}" >
                                <p:ajax event="keyup" global="false"/>
                            </p:inputText>
                        </div>
                        <div  class="ui-g-12 ui-md-2">
                            <p:outputLabel value="#{loc.documentdate}" for="cldExchangeDate" styleClass="Fs12 FontBold"/>
                            <p:calendar  id="cldExchangeDate" class="datepicker" value="#{customerToCustomerTransferBean.customerToCustomer.documentDate}" required="true" beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat}" timeControlType="select"  showOn="button" showButtonPanel="true" placeholder="#{loc.documentdate}" mask="true" navigator="true" locale="#{sessionBean.locale}" yearRange="c-100:c+20" >
                                <p:ajax event="dateSelect" global="false"/>
                            </p:calendar>
                        </div>
                        <div  class="ui-g-12 ui-md-3">
                            <p:outputLabel value="#{loc.total}" for="txtPrice" styleClass="Fs12 FontBold" />
                            <p:inputNumber id="txtPrice" decimalSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1 ? '.': ','}" 
                                           thousandSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1 ? ',': '.'}" minValue="0"
                                           roundMethod="D" decimalPlaces="#{sessionBean.user.lastBranch.currencyrounding}"
                                           value="#{customerToCustomerTransferBean.customerToCustomer.price}"  class="Wid97 TexAlRight"  placeholder="#{loc.total}" required="true">
                                <p:ajax event="keyup" process="@this" delay="1" global="false" update="txtPrice2" />
                            </p:inputNumber>
                        </div>
                        <div  class="ui-g-12 ui-md-2">
                            <p:outputLabel value="#{loc.currency}" for="slcCurrency" styleClass="Fs12 FontBold"/>
                            <p:selectOneMenu id="slcCurrency" value="#{customerToCustomerTransferBean.customerToCustomer.currency.id}"  disabled="#{customerToCustomerTransferBean.processType==1}" required="true" styleClass="Wid97" >
                                <f:selectItem itemLabel="#{loc.choose}" itemValue="0" itemDisabled="true"/> 
                                <f:selectItems value="#{sessionBean.currencies}" var="currency1" itemLabel="#{currency1.code}" itemValue="#{currency1.id}"  />
                                <p:ajax listener="#{customerToCustomerTransferBean.bringCurrency()}" global="false" />
                            </p:selectOneMenu>
                        </div>

                        <h:panelGroup  rendered="#{sessionBean.lastBranchSetting.isForeignCurrency}" >
                            <div  class="ui-g-12 ui-md-2">
                                <p:outputLabel value="#{loc.exchangerate} #{customerToCustomerTransferBean.exchange}" for="txtExchangeRate" styleClass="Fs12 FontBold" />
                                <p:inputNumber id="txtExchangeRate" decimalSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1 ? '.': ','}"  
                                               thousandSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1 ? ',': '.'}" minValue="0"
                                               roundMethod="D" decimalPlaces="4" 
                                               value="#{customerToCustomerTransferBean.customerToCustomer.exchangeRate}"  class="Wid97 TexAlRight"  placeholder="#{loc.exchangerate}" required="true">
                                    <p:ajax event="keyup" global="false" update="txtPrice2" delay="1" process="@this"/>
                                </p:inputNumber>
                            </div>
                        </h:panelGroup>

                        <div  class="ui-g-12 ui-md-2">
                            <p:outputLabel value="#{loc.total}" for="txtPrice2" styleClass="Fs12 FontBold" />
                            <p:inputNumber id="txtPrice2" decimalSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1? '.': ','}"  
                                           thousandSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1 ? ',': '.'}"
                                           roundMethod="D" decimalPlaces="#{sessionBean.user.lastBranch.currencyrounding}" readonly="true"
                                           symbolPosition="s"  symbol="#{sessionBean.currencySignOrCode(customerToCustomerTransferBean.inCurrency.id,0)}"
                                           value="#{customerToCustomerTransferBean.customerToCustomer.price*customerToCustomerTransferBean.customerToCustomer.exchangeRate}"  class="Wid97 TexAlRight"  placeholder="#{loc.total}" required="true">
                            </p:inputNumber>
                        </div>

                        <div  class="ui-g-12 ui-md-12">
                            <p:outputLabel value="#{loc.description}" for="txtAcıklama" styleClass="Fs12 FontBold" />
                            <p:inputText id="txtAcıklama" styleClass="Wid99" placeholder="#{loc.description}" value="#{customerToCustomerTransferBean.customerToCustomer.description}"  >
                                <p:ajax event="keyup" global="false"/>
                            </p:inputText>
                        </div>
                    </h:panelGroup>
                </h:panelGroup>            
            </div>
        </h:panelGroup>

        <p:remoteCommand name="showAccountBook" process="@this" oncomplete="PF('olp_account').loadContents()" actionListener="#{accountBookFilterBean.findFilterListLazyLoading([customerToCustomerTransferBean.customerToCustomer.branch],'frmAccountBookFilter','olp_account','Musteri,MTedatikçi')}"/>
    </h:form>


</ui:composition>


