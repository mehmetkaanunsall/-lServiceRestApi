<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <div class="ContainerIndent">
        <h:form id="frmFillingItemToolbar"   >
            #{automationDeviceFillingBean.clearFilter('automationDeviceFillingShelfPF')}
            <p:defaultCommand  target="test" />
            <p:commandLink  id="test" global="false" style="display: none"   />
            <p:toolbar>
                <f:facet name="left">
                    <p:inputText id="globalFilter" value="#{automationDeviceFillingBean.autoCompleteValueItem}" styleClass="tlbrSearchInput Fleft" >
                        <p:ajax event="keyup"  global="false" onstart="PF('automationDeviceFillingShelfPF').filter();hide();" update="tbvAutomationDeviceFillingProcess:frmShelfTab:dtbShelf" />
                    </p:inputText>
                    <p:watermark for="globalFilter"  value="#{loc.enteratleastonecharacter}" id="watermark"/>
                </f:facet>

            </p:toolbar>
        </h:form>
        <p:focus context="frmFillingItemToolbar:globalFilter"   for="frmFillingItemToolbar:globalFilter"/> 

        <h:form id="frmShelfTab">
            <p:commandButton id="updateDatatable" process="@this" ajax="true" global="false" style="display: none;" update="tbvAutomationDeviceFillingProcess:frmShelfTab"/>
            <p:dataTable id="dtbShelf"  var="automationDeviceItem" value="#{automationDeviceFillingBean.listOfAutomationItem}" selection="#{automationDeviceFillingBean.selectedAutomationItem}" selectionMode="single"  widgetVar="automationDeviceFillingShelfPF"
                         rowKey="#{automationDeviceItem.id}" emptyMessage="#{loc.norecordsfound}" class="tabDatatable" resizableColumns="true" editable="true" editMode="cell"
                         filteredValue="#{automationDeviceFillingBean.listOfItemFilteredObjects}">

                <p:ajax event="cellEdit" listener="#{automationDeviceFillingBean.onCellEdit}" />
                <p:ajax event="filter" global="false"/>
                <p:ajax event="#{sessionBean.user.gridRowSelect}" resetValues="true" listener="#{automationDeviceFillingBean.createShelfDialog()}" update="dlgShelfFillingProcess"  />  

                <f:facet  name="footer" >
                    <p:inputText id="globalFilter" value="#{automationDeviceFillingBean.autoCompleteValueItem}"  style="display: none" />
                </f:facet>

                <p:column id="clmBarcode" headerText="#{loc.barcode}" sortBy="#{automationDeviceItem.stock.barcode}" rendered="false" filterable="true"  filterBy="#{automationDeviceItem.stock.barcode}" filterMatchMode="contains">
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet>
                    <h:outputText value="#{automationDeviceItem.stock.barcode}" />
                </p:column>
                <p:column id="clmStock" headerText="#{loc.stock}" sortBy="#{automationDeviceItem.stock.name}"  filterable="true"  filterBy="#{automationDeviceItem.stock.name}" filterMatchMode="contains">
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet>
                    <h:outputText value="#{automationDeviceItem.stock.name}" />
                </p:column>
                <p:column id="clmShelfNo" headerText="#{loc.shelfno}" sortBy="#{automationDeviceItem.shelfNo}" filterable="true"  filterBy="#{automationDeviceItem.shelfNo}" filterMatchMode="contains">
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet>
                    <h:outputText value="#{automationDeviceItem.shelfNo}" />
                </p:column>
                <p:column id="clmType" headerText="#{loc.type}" sortBy="#{automationDeviceItem.type.tag}"  filterable="true"  filterBy="#{automationDeviceItem.type.tag}" filterMatchMode="contains">
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet>
                    <h:outputText value="#{automationDeviceItem.type.tag}" />
                </p:column>
                <p:column id="clmMaxCapacity" headerText="#{loc.maxcapacity}" sortBy="#{automationDeviceItem.maxStockLevel}" filterable="true"  filterBy="#{automationDeviceItem.maxStockLevel}" filterMatchMode="contains">
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet>
                    <h:outputText value="#{automationDeviceItem.maxStockLevel}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>
                <p:column id="clmWarehouseQuantity" headerText="#{loc.warehousequantity}" sortBy="#{automationDeviceItem.warehouseAmount}" filterable="true"  filterBy="#{automationDeviceItem.warehouseAmount}" filterMatchMode="contains">
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet>
                    <h:outputText value="#{automationDeviceItem.warehouseAmount==null ? 0 : automationDeviceItem.warehouseAmount}" class="Fright">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>
                </p:column>
                <p:column id="clmBalance" sortBy="#{automationDeviceItem.balance}" filterable="true"  filterBy="#{automationDeviceItem.warehouseAmount}" filterMatchMode="contains">
                    <f:facet name="filter">
                        <p:outputLabel   rendered="false" />
                    </f:facet>
                    <f:facet name="header">
                         <h:outputText value="#{loc.availablequantity}"/>
                          <i class="fa fa-pencil" title="#{loc.edit}"/>
                    </f:facet>
                    <p:cellEditor rendered="#{automationDeviceItem.stock.id != 0}">
                        <f:facet name="output">
                            <h:outputText value="#{automationDeviceItem.balance == null ? 0 : automationDeviceItem.balance}" class="Fright">
                                <f:converter converterId="currencyConverter" />
                                <f:attribute name="type" value="" />
                            </h:outputText>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputNumber value="#{automationDeviceItem.balance}" class="editableinput"
                                           decimalSeparator="#{sessionBean.user.lastBranch.decimalsymbol ==1 ? '.': ','}" 
                                           thousandSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1 ? ',': '.'}"
                                           decimalPlaces="#{sessionBean.user.lastBranch.currencyrounding}"
                                           roundMethod="D" emptyValue=""/>  
                        </f:facet>
                    </p:cellEditor>
                    <h:outputText value="#{automationDeviceItem.balance == null ? 0 : automationDeviceItem.balance}" class="Fright" rendered="#{automationDeviceItem.stock.id == 0}">
                        <f:converter converterId="currencyConverter" />
                        <f:attribute name="type" value="" />
                    </h:outputText>

                </p:column>
            </p:dataTable>



        </h:form>
    </div>

    <script>
        function updateDatatable() {
            document.getElementById("tbvAutomationDeviceFillingProcess:frmShelfTab:updateDatatable").click();
        }
    </script>

</ui:composition>