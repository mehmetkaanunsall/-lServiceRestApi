
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions" 
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">


    <h:form id="frmWarehouseReceiptProcess">
        <ui:include src="/pages/general/common/processtoolbar.xhtml" >
            <ui:param name="outputtext" value="#{loc.warehousereceiptprocesses}"/>
            <ui:param name="bean" value='#{warehouseReceiptProcessBean}' />
            <ui:param name="update" value="pgrWarehouseReceiptProcess" />
            <ui:param name="btnSaveId" value='#{sessionBean.user.lastBranchSetting.isCentralIntegration and sessionBean.user.lastBranchSetting.erpIntegrationId == 1 and warehouseReceiptProcessBean.processType == 2 and (warehouseReceiptProcessBean.selectedObject.type.id ==6 or warehouseReceiptProcessBean.selectedObject.type.id ==9) ? warehouseReceiptProcessBean.selectedObject.logSapİsSend ? false : warehouseReceiptProcessBean.getRendered(32, 0) : 
                                                warehouseReceiptProcessBean.processType==2 and (warehouseReceiptProcessBean.selectedObject.type.id==7 or warehouseReceiptProcessBean.selectedObject.type.id==8 or warehouseReceiptProcessBean.selectedObject.type.id==60 or warehouseReceiptProcessBean.selectedObject.type.id==61 or warehouseReceiptProcessBean.selectedObject.type.id==76) ? false : warehouseReceiptProcessBean.getRendered(32, 0)}' />     
            <ui:param name="renderback" value='true'/>
            <ui:param name="btnDeleteId" value='false' />
            <c:if test="#{warehouseReceiptProcessBean.processType==2}">
                <ui:param name="btnDeleteId" value='#{sessionBean.user.lastBranchSetting.isCentralIntegration and sessionBean.user.lastBranchSetting.erpIntegrationId == 1 and warehouseReceiptProcessBean.processType == 2  ? warehouseReceiptProcessBean.selectedObject.logSapİsSend ? false : true : warehouseReceiptProcessBean.getRendered(33, 0)}' />
                <ui:param name="btnTestBeforeDeleteId" value="true" />
                <ui:param name="renderOpen" value="#{sessionBean.user.lastBranchSetting.isCentralIntegration and sessionBean.user.lastBranchSetting.erpIntegrationId == 1 and warehouseReceiptProcessBean.getRendered(344, 0)  ? warehouseReceiptProcessBean.selectedObject.logSapİsSend ? true : false : false}"/>
                <ui:param name="titleOpen" value="#{loc.openedit}" />
            </c:if>
        </ui:include>

        <h:panelGroup id="pgrWarehouseReceiptProcess" layout="block">
            <div class="ui-g divContent">
                <div class="ui-g-12 panelToggle">
                    <p:focus for="txtSerialNo"/>

                    <div class="ui-g-12  ui-md-2">
                        <p:outputLabel value="#{loc.warehousereceiptno}" for="txtSerialNo" class="FontBold Fs12"/>
                        <p:inputText id="txtSerialNo" value="#{warehouseReceiptProcessBean.selectedObject.receiptNumber}" required="true" placeholder="#{loc.warehousereceiptno}"/>  
                    </div>

                    <div class="ui-g-12  ui-md-2">
                        <p:outputLabel value="#{loc.warehouse}" for="slcWarehouse" class="FontBold Fs12"/>
                        <p:selectOneMenu id="slcWarehouse" value="#{warehouseReceiptProcessBean.selectedObject.warehouse.id}" required="true" disabled="#{warehouseReceiptProcessBean.processType==2}"  >
                            <f:selectItems value="#{warehouseReceiptProcessBean.listOfWarehouse}" var="warehouse" itemLabel="#{warehouse.name}" itemValue="#{warehouse.id}"  />
                        </p:selectOneMenu>
                    </div>

                    <div class="ui-g-12  ui-md-2">
                        <p:outputLabel value="#{loc.entry} / #{loc.exit}" for="slcEntryExit" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcEntryExit" value="#{warehouseReceiptProcessBean.selectedObject.isDirection}" required="true" disabled="#{warehouseReceiptProcessBean.processType==2}" >
                            <f:selectItem itemValue="true" itemLabel="#{loc.entry}"  />
                            <f:selectItem itemValue="false" itemLabel="#{loc.exit}"  />
                            <p:ajax global="false" update="slcType" listener="#{warehouseReceiptProcessBean.changeEntryExit()}"/>
                        </p:selectOneMenu>
                    </div>

                    <div class="ui-g-12  ui-md-2">
                        <p:outputLabel value="#{loc.type}" for="slcType" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcType" value="#{warehouseReceiptProcessBean.selectedObject.type.id}" required="true" >
                            <f:selectItems value="#{warehouseReceiptProcessBean.listOfType}" var="type" itemLabel="#{warehouseReceiptProcessBean.selectedObject.isDirection and type.id ==61 ? loc.purchasereceipt : type.nameMap.get(sessionBean.langId).name}" itemValue="#{type.id}"  />
                        </p:selectOneMenu>
                    </div>

                    <div class="ui-g-12  ui-md-2">
                        <p:outputLabel value="#{loc.processdate}" for="cldDate" class="FontBold Fs12"/>
                        <p:calendar  id="cldDate" value="#{warehouseReceiptProcessBean.selectedObject.processDate}" required="true" class="datepicker" 
                                     beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm:ss" showOn="button" 
                                     showButtonPanel="true" placeholder="#{loc.processdate}" mask="true" navigator="true" timeControlType="select"
                                     locale="#{sessionBean.locale}" yearRange="c-100:c+20" disabled="#{warehouseReceiptProcessBean.processType==2}" >
                            <p:ajax event="change" update="cldDate" resetValues="true"/>
                        </p:calendar>
                    </div>

                </div>
            </div>           
        </h:panelGroup>
        <p:remoteCommand name="rcgoToRelatedRecord" actionListener="#{warehouseReceiptProcessBean.goToRelatedRecord()}" delay="500" process="@this"/>
        <c:if test="#{warehouseReceiptProcessBean.processType==2}">
            <p:remoteCommand name="rcgoToRelatedRecordItem" actionListener="#{warehouseReceiptStockTabBean.goToRelatedRecord()}" delay="500" process="@this"/>
        </c:if>
    </h:form>

    <div class="EmptyBox10" />

    <p:tabView id="tbvWarehouseReceiptProc" activeIndex="#{marwiz.tabIndex}" rendered="#{warehouseReceiptProcessBean.processType==2 and warehouseReceiptProcessBean.getRendered(9, 1)}" scrollable="true" dynamic="true" cache="true">
        <p:ajax event="tabChange" listener="#{warehouseReceiptProcessBean.onTabChange}" />

        <p:tab id="tab9" title="#{loc.stocks}" rendered="#{warehouseReceiptProcessBean.getRendered(9, 1)}">
            <c:if test="#{warehouseReceiptProcessBean.activeIndex==9}" >
                <ui:include src="/pages/inventory/warehousereceipt/warehousereceiptstocktab.xhtml"/>
            </c:if>
        </p:tab>


    </p:tabView>

    <p:dialog id="dlgWarehouseReceiptStockProc" widgetVar="dlg_warehousereceiptstockproc" resizable="false" width="40%" focus="dlgWarehouseReceiptStockProc" responsive="true" dynamic="true" closeOnEscape="true" modal="true">
        <c:if test="#{warehouseReceiptProcessBean.activeIndex==9}" >
            <ui:include src="/pages/inventory/warehousereceipt/warehousereceiptstockprocess.xhtml"/>
        </c:if>
    </p:dialog>

    <p:confirmDialog id="dlgRelatedRecordInfo"  class="deleteConfirm controlDelete"  widgetVar="dlg_RelatedRecordInfo" closable="true" width="20%" responsive="true">
        <f:facet name="message">
            <p:panel class="divContent">
                <div class="ui-g">
                    <div class="ui-g-12 ui-md-12 ui-lg-12">
                        <h:outputText value="#{warehouseReceiptProcessBean.deleteControlMessage}" />
                    </div>
                    <div class="ui-g-12 ui-md-12 ui-lg-12">
                        <h:outputText value="#{warehouseReceiptProcessBean.deleteControlMessage1}" />
                    </div>
                    <div class="ui-g-12 ui-md-12 ui-lg-6">
                        <h:outputText value="#{warehouseReceiptProcessBean.deleteControlMessage2}" class="Fright"/>
                    </div>
                    <div class="ui-g-12 ui-md-12 ui-lg-6">
                        <p:commandLink value="#{warehouseReceiptProcessBean.relatedRecord}" class="Fleft cmdRelatedRecord" title="#{loc.gotorelatedrecord}" actionListener="#{warehouseReceiptProcessBean.goToRelatedRecordBefore()}" />
                    </div>
                    <h:panelGroup rendered="#{warehouseReceiptProcessBean.isDeleteButton}">
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <p:commandButton value="#{loc.yes}" action="#{warehouseReceiptProcessBean.delete()}" onclick="PF('dlg_RelatedRecordInfo').hide()" process="@this" styleClass="ui-confirmdialog-yes" icon="ui-icon-check fa fa-check Fs14 white"   />
                        </div>
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <p:commandButton value="#{loc.no}" type="button" onclick="PF('dlg_RelatedRecordInfo').hide()" styleClass="ui-confirmdialog-no" icon="ui-icon-close fa fa-close Fs14 white" />
                        </div>
                    </h:panelGroup>
                </div>
            </p:panel>
        </f:facet>
    </p:confirmDialog>

    <c:if test="#{warehouseReceiptProcessBean.processType==2}">
        <p:confirmDialog id="dlgRelatedRecordInfoItem"  class="deleteConfirm controlDelete"  widgetVar="dlg_RelatedRecordInfoItem" closable="true" width="20%" responsive="true">
            <f:facet name="message">
                <p:panel class="divContent">
                    <div class="ui-g">
                        <div class="ui-g-12 ui-md-12 ui-lg-12">
                            <h:outputText value="#{warehouseReceiptStockTabBean.deleteControlMessage}" />
                        </div>
                        <div class="ui-g-12 ui-md-12 ui-lg-12">
                            <h:outputText value="#{warehouseReceiptStockTabBean.deleteControlMessage1}" />
                        </div>
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <h:outputText value="#{warehouseReceiptStockTabBean.deleteControlMessage2}" class="Fright"/>
                        </div>
                        <div class="ui-g-12 ui-md-12 ui-lg-6">
                            <p:commandLink value="#{warehouseReceiptStockTabBean.relatedRecord}" class="Fleft cmdRelatedRecord" title="#{loc.gotorelatedrecord}" actionListener="#{warehouseReceiptStockTabBean.goToRelatedRecordBefore()}" />
                        </div>
                    </div>
                </p:panel>
            </f:facet>
        </p:confirmDialog>
    </c:if>

</ui:composition>
