
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions" 
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">


    <h:form id="frmStockTakingProcess">
        <ui:include src="/pages/general/common/processtoolbar.xhtml" >
            <ui:param name="outputtext" value="#{loc.stocktakingprocesses}"/>
            <ui:param name="bean" value='#{bean}' />
            <ui:param name="update" value="pgrStockTakingProcess" />
            <ui:param name="btnSaveId" value="#{bean.selectedObject.status.id==15 and bean.getRendered(38, 0)}" />                
            <c:if test="#{bean.selectedObject.id>0}">
                <ui:param name="renderback" value='true'/>
                <ui:param name="renderSelectedObject" value='true'/>
                <ui:param name="selectedObjectName" value="#{bean.selectedObject.name}"/>
                <ui:param name="btnDeleteId" value='#{bean.getRendered(39, 0)}' />
                <ui:param name="btnTestBeforeDeleteId" value='true' />
            </c:if>
            <c:if test="#{bean.selectedObject.status.id==16}">
                <ui:param name="renderStockTaking" value='#{bean.getRendered(40, 0)}'/>
            </c:if>
        </ui:include>

        <h:panelGroup id="pgrStockTakingProcess" layout="block">
            <div class="ui-g-12 divContent">
                <div class="ui-g panelToggle">
                    <p:focus for="txtName"/>

                    <div class="ui-g-12  ui-md-12 ui-lg-3">  
                        <p:outputLabel value="#{loc.name}"   for="txtName" class="FontBold Fs12"/>
                        <p:inputText id="txtName" value="#{bean.selectedObject.name}" required="true" placeholder="#{loc.name}" disabled="#{bean.selectedObject.status.id==16 ? true : false}"/>  
                    </div>

                    <div class="ui-g-12  ui-md-12 ui-lg-3">
                        <p:outputLabel value="#{loc.warehouse}" for="slcWarehouse" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcWarehouse" value="#{bean.selectedObject.warehouse.id}" required="true" disabled="#{bean.selectedObject.id>0}" >
                            <f:selectItems value="#{bean.listOfWarehouse}" var="warehouse" itemLabel="#{warehouse.name}" itemValue="#{warehouse.id}"  />
                        </p:selectOneMenu>
                    </div>

                    <div class="ui-g-12  ui-md-12 ui-lg-3">
                        <p:outputLabel value="#{loc.control}" for="slcControl" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcControl" value="#{bean.selectedObject.isControl}" required="true" disabled="#{bean.selectedObject.status.id  == 16}">
                            <f:selectItem itemLabel="#{loc.controlled}" itemValue="true" />
                            <f:selectItem itemLabel="#{loc.uncontrolled}" itemValue="false" />
                        </p:selectOneMenu>
                    </div>

                    <div class="ui-g-12  ui-md-12 ui-lg-3">
                        <p:outputLabel value="#{loc.statu}" for="slcStatu" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcStatu" value="#{bean.selectedObject.status.id}" required="true" disabled="true" >
                            <f:selectItems value="#{sessionBean.getStatus(9)}" var="statu" itemLabel="#{statu.nameMap.get(sessionBean.langId).name}" itemValue="#{statu.id}"  />
                        </p:selectOneMenu>
                    </div>

                    <div class="ui-g-12 ui-md-6 ui-lg-3">
                        <p:outputLabel value="#{loc.pricelist}" for="slcPricelist" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcPricelist" disabled="#{bean.selectedObject.status.id  == 16}" required="true" value="#{bean.selectedObject.priceList.id}" filter="true" >
                            <f:selectItem itemLabel="#{loc.choose}" itemValue="#{null}" itemDisabled="true"   />
                            <f:selectItems value="#{bean.priceList}"  var="pricelist" itemLabel="#{pricelist.name}" itemValue="#{pricelist.id}" />
                        </p:selectOneMenu>
                    </div>

                    <div class="#{bean.selectedObject.id>0 ? 'ui-g-12 ui-md-6 ui-lg-2':'ui-g-12 ui-md-6 ui-lg-3' } ">  
                        <p:outputLabel value="#{loc.kdv}" for="oneIstaxIncluded" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="oneIstaxIncluded" disabled="#{bean.selectedObject.status.id  == 16}" required="true" value="#{bean.selectedObject.isTaxIncluded}"  >
                            <f:selectItem itemLabel="#{loc.kdv} #{loc.inclusive}" itemValue="true" />
                            <f:selectItem itemLabel="#{loc.kdv} #{loc.except}" itemValue="false" />
                        </p:selectOneMenu>
                    </div> 

                    <div class="#{bean.selectedObject.id>0 ? 'ui-g-12 ui-md-6 ui-lg-2':'ui-g-12 ui-md-6 ui-lg-3' }"> 
                        <p:outputLabel value="#{loc.stocktakingemployee}" for="slcTakingEmployee" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcTakingEmployee" required="true" value="#{bean.selectedObject.takingEmployee.id}" filter="true" disabled="#{bean.selectedObject.id>0}">
                            <f:selectItem itemLabel="#{loc.choose}" itemValue="#{null}" itemDisabled="true"   />
                            <f:selectItems value="#{bean.accountList}"  var="accountList" itemLabel="#{accountList.name} #{accountList.title}" itemValue="#{accountList.id}" />
                        </p:selectOneMenu>
                    </div>
                    <h:panelGroup>
                        <h:panelGroup rendered="#{bean.selectedObject.id>0}"  >
                            <div class="ui-g-12 ui-md-6 ui-lg-2">
                                <p:outputLabel value="#{loc.stocktakingapprovalemployee}"   for="slcApprovalEmployee" styleClass="Fs12 FontBold"/>
                                <p:selectOneMenu id="slcApprovalEmployee" value="#{bean.selectedObject.approvalEmployee.id}" disabled="#{bean.selectedObject.status.id  == 16}"  filter="true" >
                                    <f:selectItem itemLabel="#{loc.choose}" itemValue="0" />
                                    <f:selectItems value="#{bean.accountList}"  var="accountList" itemLabel="#{accountList.name} #{accountList.title}" itemValue="#{accountList.id}" />
                                </p:selectOneMenu>
                            </div>
                        </h:panelGroup>
                    </h:panelGroup>

                    <div class="ui-g-12 ui-md-6  ui-lg-3">
                        <p:outputLabel value="#{loc.stock} #{loc.category}" for="txtCategory"  styleClass="Fs12 FontBold"/>
                        <p:inputText id="txtCategory" disabled="#{bean.selectedObject.status.id  == 16}" onclick="#{bean.selectedObject.status.id==16 ? '' : 'showCategoryBook()'}" value="#{categoryBookCheckboxFilterBean.selectedCount}" class="inputPositionForBookFilter"  readonly="true"  placeholder="#{loc.all}" >
                        </p:inputText>
                        <p:commandLink id="btnCategory" disabled="#{bean.selectedObject.status.id==16}" process="@this" update="frmCategoryBookFilter" action="#{bean.openDialog()}" class="commandLinkPositionForBookFilter" oncomplete="PF('olp_Category').loadContents();">
                            <i class="fa fa-book Fs16 iconPositionForBookFilter"></i>
                            <p:ajax   listener="#{categoryBookCheckboxFilterBean.findFilterList([2],'frmCategoryBookFilter','olp_Category','stockTakingCheckbox')}" />
                        </p:commandLink>
                    </div>

                    <div class="ui-g-12 ui-md-6 ui-lg-3">
                        <p:outputLabel value="#{loc.stocktakingtype}" for="slcType" styleClass="Fs12 FontBold"/>
                        <p:selectOneMenu id="slcType" value="#{bean.selectedObject.isRetrospective}" required="true" disabled="#{bean.selectedObject.id>0}">
                            <f:selectItem itemLabel="#{loc.instant}" itemValue="false" />
                            <f:selectItem itemLabel="#{loc.retrospective}" itemValue="true" />
                            <p:ajax update="pngRetrospective"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-9" style="padding: 0px !important">
                    <h:panelGroup id="pngRetrospective">
                        <h:panelGroup rendered="#{bean.selectedObject.isRetrospective}"  >
                            <div class="ui-g-12 ui-md-6 ui-lg-4">
                                <p:outputLabel value="#{loc.startdate}" for="cldStartDate" styleClass="Fs12 FontBold"/>
                                <p:calendar  id="cldStartDate" value="#{bean.selectedObject.beginDate}" 
                                             required="true" class="datepicker" beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm" 
                                             showOn="button" showButtonPanel="true" placeholder="#{loc.startdate}" mask="true" navigator="true" timeControlType="select"
                                             locale="#{sessionBean.locale}" yearRange="c-100:c+20" disabled="#{bean.selectedObject.id>0}" >
                                    <p:ajax event="change" update="cldStartDate" resetValues="true"/>
                                </p:calendar>
                            </div>

                            <div class="ui-g-12 ui-md-6 ui-lg-4">
                                <p:outputLabel value="#{loc.enddate}" for="cldEndDate" styleClass="Fs12 FontBold"/>
                                <p:calendar  id="cldEndDate" value="#{bean.selectedObject.endDate}" 
                                             required="true" class="datepicker" beforeShow="dpClearButton" pattern="#{sessionBean.user.lastBranch.dateFormat} HH:mm" 
                                             showOn="button" showButtonPanel="true" placeholder="#{loc.enddate}" mask="true" navigator="true" timeControlType="select"
                                             locale="#{sessionBean.locale}" yearRange="c-100:c+20" disabled="#{bean.selectedObject.id>0}" >
                                    <p:ajax event="change" update="cldEndDate" resetValues="true"/>
                                </p:calendar>
                            </div>

                        </h:panelGroup>

                        <div class="#{bean.selectedObject.isRetrospective ? 'ui-g-12 ui-md-6 ui-lg-4':'ui-g-12 ui-md-6 ui-lg-12'}">
                            <p:outputLabel value="#{loc.description}" for="txtDescription" class="FontBold Fs12" />
                            <p:inputText id="txtDescription" value="#{bean.selectedObject.description}" placeholder="#{loc.description}" disabled="#{bean.selectedObject.status.id==16 ? true : false}"/>  
                        </div>
                    </h:panelGroup>
                    </div>

                </div>
            </div>
        </h:panelGroup>
        <p:remoteCommand name="showCategoryBook" process="@this" update="frmCategoryBookFilter" action="#{bean.openDialog()}" oncomplete="PF('olp_Category').loadContents();" actionListener="#{categoryBookCheckboxFilterBean.findFilterList([2],'frmCategoryBookFilter','olp_Category','stockTakingCheckbox')}" />
    </h:form>

    <p:overlayPanel id="olpCategory" widgetVar="olp_Category" showEvent="none" modal="true" transient="true" for="frmStockTakingProcess:btnCategory"  my="right top" at="left bottom" dismissable="true" hideEffect="blind" showCloseIcon="true" class="Wid30">
        <ui:include src="/pages/general/common/categorybookcheckbox.xhtml">
            <ui:param name="updateBean" value='#{bean}' />
            <ui:param name="type" value='stockTakingCheckbox' />
            <ui:param name="parameters" value='#{[2]}' /> 
            <ui:param name="form" value='frmCategoryBookFilter' /> 
        </ui:include>
    </p:overlayPanel>
</ui:composition>
