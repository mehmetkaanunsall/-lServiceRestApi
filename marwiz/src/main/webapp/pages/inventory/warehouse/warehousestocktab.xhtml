<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">


    <h:panelGroup id="pgrStockDatatable" layout="block">
        <div class="ContainerIndent"> 
            <ui:include src="/pages/general/common/datagridtoolbar.xhtml" >
                <ui:param name="bean" value="#{warehouseStockTabBean}"/>   <!-- Bean -->
                <ui:param name="update" value="dlgWarehouseStockProc"/>  <!-- Yeni butonuna basınca açılacak sayfa  -->
                <ui:param name="btnNewId" value="false"/>  <!-- buton id yetki kontrolü için  -->
                <ui:param name="datatable" value="tbvWarehouseProc:frmStockTab:dtbStock" />  <!-- datatable  -->
                <ui:param name="dtbWidgetVar" value="stockPF" />  <!--   datatable WidgetVar  -->
                <ui:param name="detailFilterXhtmlPath" value="" /> <!-- detaylı filtre alanlarının xhtml yolu  -->
                <ui:param name="filterBean" value=""/> <!-- detaylı filtre alanlarının xhtml bean  -->
                <ui:param name="fileName" value="#{loc.stocks}"/>
                <ui:param name="renderedFilter" value='false'/>
                <ui:param name="renderedToggler" value='false'/>
                <ui:param name="renderedExel" value='true'/>
                <ui:param name="renderedPdf" value='true'/>
                <ui:param name="renderedAdd" value='true'/>
                <ui:param name="renderedStockBook" value='#{warehouseStockTabBean.wareHouse.isAutomat ? false : warehouseStockTabBean.getRendered(148, 0)}'/>
                <ui:param name="gridId" value="99"/>
                <ui:param name="renderedSpecialExport" value='true'/>
            </ui:include>


            <h:form id="frmStockTab" >


                <p:dataTable  id="dtbStock" value="#{warehouseStockTabBean.listOfObjects}" var="Stock" widgetVar="stockPF" selectionMode="single" selection="#{warehouseStockTabBean.selectedObject}" emptyMessage="#{loc.norecordsfound}"
                              rowKey="#{Stock.id}" rows="#{sessionBean.user.defualtGridSize}" paginator="true" paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {CurrentPageReport}"
                              rowsPerPageTemplate="#{sessionBean.user.gridSize}" paginatorPosition="bottom" currentPageReportTemplate="{startRecord}-{endRecord} #{loc.intotal} {totalRecords}"  reflow="true" lazy="true"
                              rowStyleClass="#{0>Stock.quantity ? 'ColumnColorRed' : null}" editable="true" editMode="cell" >                   


                    <p:ajax event="cellEdit" listener="#{warehouseStockTabBean.onCellEdit}" />
                    <p:ajax event="#{sessionBean.user.gridRowSelect}" update="dlgWarehouseStockProc" resetValues="true" listener="#{warehouseStockTabBean.update()}" process="@this"    />  
                    <p:ajax event="colReorder" listener="#{warehouseStockTabBean.reorder}"  />     
                    <p:ajax event="colResize"  listener="#{warehouseStockTabBean.onResize}" />

                    <p:column id="clmStockCode" headerText="#{loc.stockcode}" sortable="true" sortBy="#{Stock.stck.code}"  >

                        <h:outputText  value="#{Stock.stock.code}" />
                    </p:column> 

                    <p:column id="clmCenterStockCode" headerText="#{loc.centerstockcode}" sortable="true" sortBy="#{Stock.stck.centerProductCode}"  >

                        <h:outputText  value="#{Stock.stock.centerProductCode}" />
                    </p:column> 

                    <p:column id="clmBarcode" headerText="#{loc.stockbarcode}" sortBy="#{Stock.stck.barcode}" sortable="true" >
                        <h:outputText value="#{Stock.stock.barcode}" />
                    </p:column>

                    <p:column id="clmStockName" headerText="#{loc.stockname}" sortable="true" sortBy="#{Stock.stck.name}"  >

                        <h:outputText  value="#{Stock.stock.name}" />
                    </p:column> 
                    <p:column id="clmBalance" headerText="#{loc.balance}" sortable="true" sortBy="#{Stock.iwi.quantity}" exportable="false"  >

                        <h:outputText style="float:right;"  value="#{Stock.quantity}">
                            <f:converter converterId="currencyConverter" />
                            <f:attribute name="unit" value="#{Stock.stock.unit}"/>
                            <f:attribute name="type" value="unit" />
                        </h:outputText>
                    </p:column> 
                    <p:column id="clmMinStockLevel" headerText="#{loc.minstocklevel}" sortable="true" sortBy="#{Stock.minStockLevel}" >
                        <p:cellEditor>
                            <f:facet name="output">
                                <h:outputText value="#{Stock.minStockLevel}" style="float: right" >
                                    <f:converter converterId="currencyConverter" />
                                    <f:attribute name="type" value="" />
                                </h:outputText>
                            </f:facet>
                            <f:facet name="input">
                                <p:inputNumber value="#{Stock.minStockLevel}" class="editableinput"
                                               decimalSeparator="#{sessionBean.user.lastBranch.decimalsymbol ==1 ? '.': ','}"
                                               thousandSeparator="#{sessionBean.user.lastBranch.decimalsymbol==1 ? ',': '.'}"
                                               decimalPlaces="#{sessionBean.user.lastBranch.currencyrounding}"
                                               roundMethod="D" emptyValue=""/>  
                            </f:facet>
                        </p:cellEditor>
                    </p:column>
                    <p:column id="clmBalance1" headerText="#{loc.balance}"  exportable="true" visible="false"  >

                        <h:outputText style="float:right;"  value="#{warehouseStockTabBean.unitNumberFormat(Stock.stock.unit.unitRounding).format(Stock.quantity)}">

                        </h:outputText>
                    </p:column> 
                    <p:column id="clmUnit1" headerText="#{loc.unit}"  exportable="true" visible="false"  >

                        <h:outputText style="float:right;" value="#{Stock.stock.unit.sortName}">

                        </h:outputText>
                    </p:column> 


                </p:dataTable>             

            </h:form>
        </div>
    </h:panelGroup>
</ui:composition>



